(self.webpackChunkvht11=self.webpackChunkvht11||[]).push([["C:\\Users\\huynh\\IdeaProjects\\vht11\\node_modules\\@pixi\\mesh\\lib\\mesh.es"],{"./node_modules/@pixi/mesh/lib/mesh.es.js":(t,e,r)=>{"use strict";r.r(e),r.d(e,{Mesh:()=>c,MeshBatchUvs:()=>d,MeshGeometry:()=>y,MeshMaterial:()=>m});var i=r("./node_modules/@pixi/core/lib/core.es.js"),n=r("./node_modules/@pixi/math/lib/math.es.js"),a=r("./node_modules/@pixi/constants/lib/constants.es.js"),s=r("./node_modules/@pixi/display/lib/display.es.js"),o=r("./node_modules/@pixi/settings/lib/settings.es.js"),u=r("./node_modules/@pixi/utils/lib/utils.es.js"),h=function(t,e){return(h=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(t,e)};function l(t,e){function r(){this.constructor=t}h(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}var d=function(){function t(t,e){this.uvBuffer=t,this.uvMatrix=e,this.data=null,this._bufferUpdateId=-1,this._textureUpdateId=-1,this._updateID=0}return t.prototype.update=function(t){if(t||this._bufferUpdateId!==this.uvBuffer._updateID||this._textureUpdateId!==this.uvMatrix._updateID){this._bufferUpdateId=this.uvBuffer._updateID,this._textureUpdateId=this.uvMatrix._updateID;var e=this.uvBuffer.data;this.data&&this.data.length===e.length||(this.data=new Float32Array(e.length)),this.uvMatrix.multiplyUvs(e,this.data),this._updateID++}},t}(),f=new n.Point,p=new n.Polygon,c=function(t){function e(e,r,n,s){void 0===s&&(s=a.DRAW_MODES.TRIANGLES);var u=t.call(this)||this;return u.geometry=e,e.refCount++,u.shader=r,u.state=n||i.State.for2d(),u.drawMode=s,u.start=0,u.size=0,u.uvs=null,u.indices=null,u.vertexData=new Float32Array(1),u.vertexDirty=0,u._transformID=-1,u._roundPixels=o.settings.ROUND_PIXELS,u.batchUvs=null,u}return l(e,t),Object.defineProperty(e.prototype,"uvBuffer",{get:function(){return this.geometry.buffers[1]},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"verticesBuffer",{get:function(){return this.geometry.buffers[0]},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"material",{get:function(){return this.shader},set:function(t){this.shader=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"blendMode",{get:function(){return this.state.blendMode},set:function(t){this.state.blendMode=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"roundPixels",{get:function(){return this._roundPixels},set:function(t){this._roundPixels!==t&&(this._transformID=-1),this._roundPixels=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"tint",{get:function(){return this.shader.tint},set:function(t){this.shader.tint=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"texture",{get:function(){return this.shader.texture},set:function(t){this.shader.texture=t},enumerable:!1,configurable:!0}),e.prototype._render=function(t){var r=this.geometry.buffers[0].data;this.shader.batchable&&this.drawMode===a.DRAW_MODES.TRIANGLES&&r.length<2*e.BATCHABLE_SIZE?this._renderToBatch(t):this._renderDefault(t)},e.prototype._renderDefault=function(t){var e=this.shader;e.alpha=this.worldAlpha,e.update&&e.update(),t.batch.flush(),e.program.uniformData.translationMatrix&&(e.uniforms.translationMatrix=this.transform.worldTransform.toArray(!0)),t.shader.bind(e),t.state.set(this.state),t.geometry.bind(this.geometry,e),t.geometry.draw(this.drawMode,this.size,this.start,this.geometry.instanceCount)},e.prototype._renderToBatch=function(t){var e=this.geometry;this.shader.uvMatrix&&(this.shader.uvMatrix.update(),this.calculateUvs()),this.calculateVertices(),this.indices=e.indexBuffer.data,this._tintRGB=this.shader._tintRGB,this._texture=this.shader.texture;var r=this.material.pluginName;t.batch.setObjectRenderer(t.plugins[r]),t.plugins[r].render(this)},e.prototype.calculateVertices=function(){var t=this.geometry,e=t.buffers[0].data;if(t.vertexDirtyId!==this.vertexDirty||this._transformID!==this.transform._worldID){this._transformID=this.transform._worldID,this.vertexData.length!==e.length&&(this.vertexData=new Float32Array(e.length));for(var r=this.transform.worldTransform,i=r.a,n=r.b,a=r.c,s=r.d,u=r.tx,h=r.ty,l=this.vertexData,d=0;d<l.length/2;d++){var f=e[2*d],p=e[2*d+1];l[2*d]=i*f+a*p+u,l[2*d+1]=n*f+s*p+h}if(this._roundPixels){var c=o.settings.RESOLUTION;for(d=0;d<l.length;++d)l[d]=Math.round((l[d]*c|0)/c)}this.vertexDirty=t.vertexDirtyId}},e.prototype.calculateUvs=function(){var t=this.geometry.buffers[1];this.shader.uvMatrix.isSimple?this.uvs=t.data:(this.batchUvs||(this.batchUvs=new d(t,this.shader.uvMatrix)),this.batchUvs.update(),this.uvs=this.batchUvs.data)},e.prototype._calculateBounds=function(){this.calculateVertices(),this._bounds.addVertexData(this.vertexData,0,this.vertexData.length)},e.prototype.containsPoint=function(t){if(!this.getBounds().contains(t.x,t.y))return!1;this.worldTransform.applyInverse(t,f);for(var e=this.geometry.getBuffer("aVertexPosition").data,r=p.points,i=this.geometry.getIndex().data,n=i.length,a=4===this.drawMode?3:1,s=0;s+2<n;s+=a){var o=2*i[s],u=2*i[s+1],h=2*i[s+2];if(r[0]=e[o],r[1]=e[o+1],r[2]=e[u],r[3]=e[u+1],r[4]=e[h],r[5]=e[h+1],p.contains(f.x,f.y))return!0}return!1},e.prototype.destroy=function(e){t.prototype.destroy.call(this,e),this.geometry.refCount--,0===this.geometry.refCount&&this.geometry.dispose(),this.geometry=null,this.shader=null,this.state=null,this.uvs=null,this.indices=null,this.vertexData=null},e.BATCHABLE_SIZE=100,e}(s.Container),m=function(t){function e(e,r){var a=this,s={uSampler:e,alpha:1,uTextureMatrix:n.Matrix.IDENTITY,uColor:new Float32Array([1,1,1,1])};return(r=Object.assign({tint:16777215,alpha:1,pluginName:"batch"},r)).uniforms&&Object.assign(s,r.uniforms),(a=t.call(this,r.program||i.Program.from("attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\nuniform mat3 translationMatrix;\nuniform mat3 uTextureMatrix;\n\nvarying vec2 vTextureCoord;\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n\n    vTextureCoord = (uTextureMatrix * vec3(aTextureCoord, 1.0)).xy;\n}\n","varying vec2 vTextureCoord;\nuniform vec4 uColor;\n\nuniform sampler2D uSampler;\n\nvoid main(void)\n{\n    gl_FragColor = texture2D(uSampler, vTextureCoord) * uColor;\n}\n"),s)||this)._colorDirty=!1,a.uvMatrix=new i.TextureMatrix(e),a.batchable=void 0===r.program,a.pluginName=r.pluginName,a.tint=r.tint,a.alpha=r.alpha,a}return l(e,t),Object.defineProperty(e.prototype,"texture",{get:function(){return this.uniforms.uSampler},set:function(t){this.uniforms.uSampler!==t&&(this.uniforms.uSampler=t,this.uvMatrix.texture=t)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"alpha",{get:function(){return this._alpha},set:function(t){t!==this._alpha&&(this._alpha=t,this._colorDirty=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"tint",{get:function(){return this._tint},set:function(t){t!==this._tint&&(this._tint=t,this._tintRGB=(t>>16)+(65280&t)+((255&t)<<16),this._colorDirty=!0)},enumerable:!1,configurable:!0}),e.prototype.update=function(){if(this._colorDirty){this._colorDirty=!1;var t=this.texture.baseTexture;(0,u.premultiplyTintToRgba)(this._tint,this._alpha,this.uniforms.uColor,t.alphaMode)}this.uvMatrix.update()&&(this.uniforms.uTextureMatrix=this.uvMatrix.mapCoord)},e}(i.Shader),y=function(t){function e(e,r,n){var s=t.call(this)||this,o=new i.Buffer(e),u=new i.Buffer(r,!0),h=new i.Buffer(n,!0,!0);return s.addAttribute("aVertexPosition",o,2,!1,a.TYPES.FLOAT).addAttribute("aTextureCoord",u,2,!1,a.TYPES.FLOAT).addIndex(h),s._updateId=-1,s}return l(e,t),Object.defineProperty(e.prototype,"vertexDirtyId",{get:function(){return this.buffers[0]._updateID},enumerable:!1,configurable:!0}),e}(i.Geometry)}}]);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly92aHQxMS8uL25vZGVfbW9kdWxlcy9AcGl4aS9tZXNoL2xpYi9tZXNoLmVzLmpzIl0sIm5hbWVzIjpbImV4dGVuZFN0YXRpY3MiLCJkIiwiYiIsIk9iamVjdCIsInNldFByb3RvdHlwZU9mIiwiX19wcm90b19fIiwiQXJyYXkiLCJwIiwiaGFzT3duUHJvcGVydHkiLCJfX2V4dGVuZHMiLCJfXyIsInRoaXMiLCJjb25zdHJ1Y3RvciIsInByb3RvdHlwZSIsImNyZWF0ZSIsIk1lc2hCYXRjaFV2cyIsInV2QnVmZmVyIiwidXZNYXRyaXgiLCJkYXRhIiwiX2J1ZmZlclVwZGF0ZUlkIiwiX3RleHR1cmVVcGRhdGVJZCIsIl91cGRhdGVJRCIsInVwZGF0ZSIsImZvcmNlVXBkYXRlIiwibGVuZ3RoIiwiRmxvYXQzMkFycmF5IiwibXVsdGlwbHlVdnMiLCJ0ZW1wUG9pbnQiLCJQb2ludCIsInRlbXBQb2x5Z29uIiwiUG9seWdvbiIsIk1lc2giLCJfc3VwZXIiLCJnZW9tZXRyeSIsInNoYWRlciIsInN0YXRlIiwiZHJhd01vZGUiLCJEUkFXX01PREVTIiwiX3RoaXMiLCJjYWxsIiwicmVmQ291bnQiLCJTdGF0ZSIsInN0YXJ0Iiwic2l6ZSIsInV2cyIsImluZGljZXMiLCJ2ZXJ0ZXhEYXRhIiwidmVydGV4RGlydHkiLCJfdHJhbnNmb3JtSUQiLCJfcm91bmRQaXhlbHMiLCJzZXR0aW5ncyIsImJhdGNoVXZzIiwiZGVmaW5lUHJvcGVydHkiLCJnZXQiLCJidWZmZXJzIiwiZW51bWVyYWJsZSIsImNvbmZpZ3VyYWJsZSIsInNldCIsInZhbHVlIiwiYmxlbmRNb2RlIiwidGludCIsInRleHR1cmUiLCJfcmVuZGVyIiwicmVuZGVyZXIiLCJ2ZXJ0aWNlcyIsImJhdGNoYWJsZSIsIkJBVENIQUJMRV9TSVpFIiwiX3JlbmRlclRvQmF0Y2giLCJfcmVuZGVyRGVmYXVsdCIsImFscGhhIiwid29ybGRBbHBoYSIsImJhdGNoIiwiZmx1c2giLCJwcm9ncmFtIiwidW5pZm9ybURhdGEiLCJ0cmFuc2xhdGlvbk1hdHJpeCIsInVuaWZvcm1zIiwidHJhbnNmb3JtIiwid29ybGRUcmFuc2Zvcm0iLCJ0b0FycmF5IiwiYmluZCIsImRyYXciLCJpbnN0YW5jZUNvdW50IiwiY2FsY3VsYXRlVXZzIiwiY2FsY3VsYXRlVmVydGljZXMiLCJpbmRleEJ1ZmZlciIsIl90aW50UkdCIiwiX3RleHR1cmUiLCJwbHVnaW5OYW1lIiwibWF0ZXJpYWwiLCJzZXRPYmplY3RSZW5kZXJlciIsInBsdWdpbnMiLCJyZW5kZXIiLCJ2ZXJ0ZXhEaXJ0eUlkIiwiX3dvcmxkSUQiLCJ3dCIsImEiLCJjIiwidHgiLCJ0eSIsImkiLCJ4IiwieSIsInJlc29sdXRpb24iLCJNYXRoIiwicm91bmQiLCJnZW9tVXZzIiwiaXNTaW1wbGUiLCJfY2FsY3VsYXRlQm91bmRzIiwiX2JvdW5kcyIsImFkZFZlcnRleERhdGEiLCJjb250YWluc1BvaW50IiwicG9pbnQiLCJnZXRCb3VuZHMiLCJjb250YWlucyIsImFwcGx5SW52ZXJzZSIsImdldEJ1ZmZlciIsInBvaW50cyIsImdldEluZGV4IiwibGVuIiwic3RlcCIsImluZDAiLCJpbmQxIiwiaW5kMiIsImRlc3Ryb3kiLCJvcHRpb25zIiwiZGlzcG9zZSIsIkNvbnRhaW5lciIsIk1lc2hNYXRlcmlhbCIsInVTYW1wbGVyIiwidVRleHR1cmVNYXRyaXgiLCJNYXRyaXgiLCJ1Q29sb3IiLCJhc3NpZ24iLCJQcm9ncmFtIiwiX2NvbG9yRGlydHkiLCJUZXh0dXJlTWF0cml4IiwidW5kZWZpbmVkIiwiX2FscGhhIiwiX3RpbnQiLCJiYXNlVGV4dHVyZSIsInByZW11bHRpcGx5VGludFRvUmdiYSIsImFscGhhTW9kZSIsIm1hcENvb3JkIiwiU2hhZGVyIiwiTWVzaEdlb21ldHJ5IiwiaW5kZXgiLCJ2ZXJ0aWNlc0J1ZmZlciIsIkJ1ZmZlciIsInV2c0J1ZmZlciIsImFkZEF0dHJpYnV0ZSIsIlRZUEVTIiwiYWRkSW5kZXgiLCJfdXBkYXRlSWQiLCJHZW9tZXRyeSJdLCJtYXBwaW5ncyI6ImttQkE4QklBLEVBQWdCLFNBQVNDLEVBQUdDLEdBSTVCLE9BSEFGLEVBQWdCRyxPQUFPQyxnQkFDbEIsQ0FBRUMsVUFBVyxjQUFnQkMsT0FBUyxTQUFVTCxFQUFHQyxHQUFLRCxFQUFFSSxVQUFZSCxJQUN2RSxTQUFVRCxFQUFHQyxHQUFLLElBQUssSUFBSUssS0FBS0wsRUFBU0EsRUFBRU0sZUFBZUQsS0FBTU4sRUFBRU0sR0FBS0wsRUFBRUssTUFDeEROLEVBQUdDLElBRzVCLFNBQVNPLEVBQVVSLEVBQUdDLEdBRWxCLFNBQVNRLElBQU9DLEtBQUtDLFlBQWNYLEVBRG5DRCxFQUFjQyxFQUFHQyxHQUVqQkQsRUFBRVksVUFBa0IsT0FBTlgsRUFBYUMsT0FBT1csT0FBT1osSUFBTVEsRUFBR0csVUFBWVgsRUFBRVcsVUFBVyxJQUFJSCxHQVNuRixJQUFJSyxFQUE4QixXQUs5QixTQUFTQSxFQUFhQyxFQUFVQyxHQUs1Qk4sS0FBS0ssU0FBV0EsRUFLaEJMLEtBQUtNLFNBQVdBLEVBTWhCTixLQUFLTyxLQUFPLEtBQ1pQLEtBQUtRLGlCQUFtQixFQUN4QlIsS0FBS1Msa0JBQW9CLEVBQ3pCVCxLQUFLVSxVQUFZLEVBc0JyQixPQWZBTixFQUFhRixVQUFVUyxPQUFTLFNBQVVDLEdBQ3RDLEdBQUtBLEdBQ0VaLEtBQUtRLGtCQUFvQlIsS0FBS0ssU0FBU0ssV0FDdkNWLEtBQUtTLG1CQUFxQlQsS0FBS00sU0FBU0ksVUFGL0MsQ0FLQVYsS0FBS1EsZ0JBQWtCUixLQUFLSyxTQUFTSyxVQUNyQ1YsS0FBS1MsaUJBQW1CVCxLQUFLTSxTQUFTSSxVQUN0QyxJQUFJSCxFQUFPUCxLQUFLSyxTQUFTRSxLQUNwQlAsS0FBS08sTUFBUVAsS0FBS08sS0FBS00sU0FBV04sRUFBS00sU0FDeENiLEtBQUtPLEtBQU8sSUFBSU8sYUFBYVAsRUFBS00sU0FFdENiLEtBQUtNLFNBQVNTLFlBQVlSLEVBQU1QLEtBQUtPLE1BQ3JDUCxLQUFLVSxjQUVGTixFQTlDc0IsR0FpRDdCWSxFQUFZLElBQUksRUFBQUMsTUFDaEJDLEVBQWMsSUFBSSxFQUFBQyxRQW1CbEJDLEVBQXNCLFNBQVVDLEdBU2hDLFNBQVNELEVBQUtFLEVBQVVDLEVBQVFDLEVBQU9DLFFBQ2xCLElBQWJBLElBQXVCQSxFQUFXLEVBQUFDLFdBQUEsV0FDdEMsSUFBSUMsRUFBUU4sRUFBT08sS0FBSzVCLE9BQVNBLEtBZ0ZqQyxPQXhFQTJCLEVBQU1MLFNBQVdBLEVBQ2pCQSxFQUFTTyxXQU1URixFQUFNSixPQUFTQSxFQU1mSSxFQUFNSCxNQUFRQSxHQUFTLEVBQUFNLE1BQUEsUUFPdkJILEVBQU1GLFNBQVdBLEVBTWpCRSxFQUFNSSxNQUFRLEVBTWRKLEVBQU1LLEtBQU8sRUFNYkwsRUFBTU0sSUFBTSxLQU1aTixFQUFNTyxRQUFVLEtBTWhCUCxFQUFNUSxXQUFhLElBQUlyQixhQUFhLEdBT3BDYSxFQUFNUyxZQUFjLEVBQ3BCVCxFQUFNVSxjQUFnQixFQU90QlYsRUFBTVcsYUFBZSxFQUFBQyxTQUFBLGFBTXJCWixFQUFNYSxTQUFXLEtBQ1ZiLEVBMFNYLE9BcFlBN0IsRUFBVXNCLEVBQU1DLEdBNEZoQjdCLE9BQU9pRCxlQUFlckIsRUFBS2xCLFVBQVcsV0FBWSxDQU05Q3dDLElBQUssV0FDRCxPQUFPMUMsS0FBS3NCLFNBQVNxQixRQUFRLElBRWpDQyxZQUFZLEVBQ1pDLGNBQWMsSUFFbEJyRCxPQUFPaUQsZUFBZXJCLEVBQUtsQixVQUFXLGlCQUFrQixDQU9wRHdDLElBQUssV0FDRCxPQUFPMUMsS0FBS3NCLFNBQVNxQixRQUFRLElBRWpDQyxZQUFZLEVBQ1pDLGNBQWMsSUFFbEJyRCxPQUFPaUQsZUFBZXJCLEVBQUtsQixVQUFXLFdBQVksQ0FDOUN3QyxJQUFLLFdBQ0QsT0FBTzFDLEtBQUt1QixRQU1oQnVCLElBQUssU0FBVUMsR0FDWC9DLEtBQUt1QixPQUFTd0IsR0FFbEJILFlBQVksRUFDWkMsY0FBYyxJQUVsQnJELE9BQU9pRCxlQUFlckIsRUFBS2xCLFVBQVcsWUFBYSxDQUMvQ3dDLElBQUssV0FDRCxPQUFPMUMsS0FBS3dCLE1BQU13QixXQVV0QkYsSUFBSyxTQUFVQyxHQUNYL0MsS0FBS3dCLE1BQU13QixVQUFZRCxHQUUzQkgsWUFBWSxFQUNaQyxjQUFjLElBRWxCckQsT0FBT2lELGVBQWVyQixFQUFLbEIsVUFBVyxjQUFlLENBQ2pEd0MsSUFBSyxXQUNELE9BQU8xQyxLQUFLc0MsY0FXaEJRLElBQUssU0FBVUMsR0FDUC9DLEtBQUtzQyxlQUFpQlMsSUFDdEIvQyxLQUFLcUMsY0FBZ0IsR0FFekJyQyxLQUFLc0MsYUFBZVMsR0FFeEJILFlBQVksRUFDWkMsY0FBYyxJQUVsQnJELE9BQU9pRCxlQUFlckIsRUFBS2xCLFVBQVcsT0FBUSxDQVExQ3dDLElBQUssV0FDRCxPQUFPMUMsS0FBS3VCLE9BQU8wQixNQUV2QkgsSUFBSyxTQUFVQyxHQUNYL0MsS0FBS3VCLE9BQU8wQixLQUFPRixHQUV2QkgsWUFBWSxFQUNaQyxjQUFjLElBRWxCckQsT0FBT2lELGVBQWVyQixFQUFLbEIsVUFBVyxVQUFXLENBTTdDd0MsSUFBSyxXQUNELE9BQU8xQyxLQUFLdUIsT0FBTzJCLFNBRXZCSixJQUFLLFNBQVVDLEdBQ1gvQyxLQUFLdUIsT0FBTzJCLFFBQVVILEdBRTFCSCxZQUFZLEVBQ1pDLGNBQWMsSUFPbEJ6QixFQUFLbEIsVUFBVWlELFFBQVUsU0FBVUMsR0FHL0IsSUFBSUMsRUFBV3JELEtBQUtzQixTQUFTcUIsUUFBUSxHQUFHcEMsS0FFcENQLEtBQUt1QixPQUFPK0IsV0FDVHRELEtBQUt5QixXQUFhLEVBQUFDLFdBQUEsV0FDbEIyQixFQUFTeEMsT0FBK0IsRUFBdEJPLEVBQUttQyxlQUMxQnZELEtBQUt3RCxlQUFlSixHQUdwQnBELEtBQUt5RCxlQUFlTCxJQVE1QmhDLEVBQUtsQixVQUFVdUQsZUFBaUIsU0FBVUwsR0FDdEMsSUFBSTdCLEVBQVN2QixLQUFLdUIsT0FDbEJBLEVBQU9tQyxNQUFRMUQsS0FBSzJELFdBQ2hCcEMsRUFBT1osUUFDUFksRUFBT1osU0FFWHlDLEVBQVNRLE1BQU1DLFFBQ1h0QyxFQUFPdUMsUUFBUUMsWUFBWUMsb0JBQzNCekMsRUFBTzBDLFNBQVNELGtCQUFvQmhFLEtBQUtrRSxVQUFVQyxlQUFlQyxTQUFRLElBRzlFaEIsRUFBUzdCLE9BQU84QyxLQUFLOUMsR0FFckI2QixFQUFTNUIsTUFBTXNCLElBQUk5QyxLQUFLd0IsT0FFeEI0QixFQUFTOUIsU0FBUytDLEtBQUtyRSxLQUFLc0IsU0FBVUMsR0FFdEM2QixFQUFTOUIsU0FBU2dELEtBQUt0RSxLQUFLeUIsU0FBVXpCLEtBQUtnQyxLQUFNaEMsS0FBSytCLE1BQU8vQixLQUFLc0IsU0FBU2lELGdCQU8vRW5ELEVBQUtsQixVQUFVc0QsZUFBaUIsU0FBVUosR0FDdEMsSUFBSTlCLEVBQVd0QixLQUFLc0IsU0FDaEJ0QixLQUFLdUIsT0FBT2pCLFdBQ1pOLEtBQUt1QixPQUFPakIsU0FBU0ssU0FDckJYLEtBQUt3RSxnQkFHVHhFLEtBQUt5RSxvQkFDTHpFLEtBQUtrQyxRQUFVWixFQUFTb0QsWUFBWW5FLEtBQ3BDUCxLQUFLMkUsU0FBVzNFLEtBQUt1QixPQUFPb0QsU0FDNUIzRSxLQUFLNEUsU0FBVzVFLEtBQUt1QixPQUFPMkIsUUFDNUIsSUFBSTJCLEVBQWE3RSxLQUFLOEUsU0FBU0QsV0FDL0J6QixFQUFTUSxNQUFNbUIsa0JBQWtCM0IsRUFBUzRCLFFBQVFILElBQ2xEekIsRUFBUzRCLFFBQVFILEdBQVlJLE9BQU9qRixPQUt4Q29CLEVBQUtsQixVQUFVdUUsa0JBQW9CLFdBQy9CLElBQUluRCxFQUFXdEIsS0FBS3NCLFNBQ2hCK0IsRUFBVy9CLEVBQVNxQixRQUFRLEdBQUdwQyxLQUNuQyxHQUFJZSxFQUFTNEQsZ0JBQWtCbEYsS0FBS29DLGFBQWVwQyxLQUFLcUMsZUFBaUJyQyxLQUFLa0UsVUFBVWlCLFNBQXhGLENBR0FuRixLQUFLcUMsYUFBZXJDLEtBQUtrRSxVQUFVaUIsU0FDL0JuRixLQUFLbUMsV0FBV3RCLFNBQVd3QyxFQUFTeEMsU0FDcENiLEtBQUttQyxXQUFhLElBQUlyQixhQUFhdUMsRUFBU3hDLFNBVWhELElBUkEsSUFBSXVFLEVBQUtwRixLQUFLa0UsVUFBVUMsZUFDcEJrQixFQUFJRCxFQUFHQyxFQUNQOUYsRUFBSTZGLEVBQUc3RixFQUNQK0YsRUFBSUYsRUFBR0UsRUFDUGhHLEVBQUk4RixFQUFHOUYsRUFDUGlHLEVBQUtILEVBQUdHLEdBQ1JDLEVBQUtKLEVBQUdJLEdBQ1JyRCxFQUFhbkMsS0FBS21DLFdBQ2JzRCxFQUFJLEVBQUdBLEVBQUl0RCxFQUFXdEIsT0FBUyxFQUFHNEUsSUFBSyxDQUM1QyxJQUFJQyxFQUFJckMsRUFBYyxFQUFKb0MsR0FDZEUsRUFBSXRDLEVBQWMsRUFBSm9DLEVBQVMsR0FDM0J0RCxFQUFnQixFQUFKc0QsR0FBV0osRUFBSUssRUFBTUosRUFBSUssRUFBS0osRUFDMUNwRCxFQUFnQixFQUFKc0QsRUFBUyxHQUFNbEcsRUFBSW1HLEVBQU1wRyxFQUFJcUcsRUFBS0gsRUFFbEQsR0FBSXhGLEtBQUtzQyxhQUNMLEtBQUlzRCxFQUFhLEVBQUFyRCxTQUFBLFdBQ2pCLElBQVNrRCxFQUFJLEVBQUdBLEVBQUl0RCxFQUFXdEIsU0FBVTRFLEVBQ3JDdEQsRUFBV3NELEdBQUtJLEtBQUtDLE9BQU8zRCxFQUFXc0QsR0FBS0csRUFBYSxHQUFLQSxHQUd0RTVGLEtBQUtvQyxZQUFjZCxFQUFTNEQsZ0JBS2hDOUQsRUFBS2xCLFVBQVVzRSxhQUFlLFdBQzFCLElBQUl1QixFQUFVL0YsS0FBS3NCLFNBQVNxQixRQUFRLEdBQy9CM0MsS0FBS3VCLE9BQU9qQixTQUFTMEYsU0FRdEJoRyxLQUFLaUMsSUFBTThELEVBQVF4RixNQVBkUCxLQUFLd0MsV0FDTnhDLEtBQUt3QyxTQUFXLElBQUlwQyxFQUFhMkYsRUFBUy9GLEtBQUt1QixPQUFPakIsV0FFMUROLEtBQUt3QyxTQUFTN0IsU0FDZFgsS0FBS2lDLElBQU1qQyxLQUFLd0MsU0FBU2pDLE9BWWpDYSxFQUFLbEIsVUFBVStGLGlCQUFtQixXQUM5QmpHLEtBQUt5RSxvQkFDTHpFLEtBQUtrRyxRQUFRQyxjQUFjbkcsS0FBS21DLFdBQVksRUFBR25DLEtBQUttQyxXQUFXdEIsU0FRbkVPLEVBQUtsQixVQUFVa0csY0FBZ0IsU0FBVUMsR0FDckMsSUFBS3JHLEtBQUtzRyxZQUFZQyxTQUFTRixFQUFNWCxFQUFHVyxFQUFNVixHQUMxQyxPQUFPLEVBRVgzRixLQUFLbUUsZUFBZXFDLGFBQWFILEVBQU9yRixHQU14QyxJQUxBLElBQUlxQyxFQUFXckQsS0FBS3NCLFNBQVNtRixVQUFVLG1CQUFtQmxHLEtBQ3REbUcsRUFBU3hGLEVBQVl3RixPQUNyQnhFLEVBQVVsQyxLQUFLc0IsU0FBU3FGLFdBQVdwRyxLQUNuQ3FHLEVBQU0xRSxFQUFRckIsT0FDZGdHLEVBQXlCLElBQWxCN0csS0FBS3lCLFNBQWlCLEVBQUksRUFDNUJnRSxFQUFJLEVBQUdBLEVBQUksRUFBSW1CLEVBQUtuQixHQUFLb0IsRUFBTSxDQUNwQyxJQUFJQyxFQUFvQixFQUFiNUUsRUFBUXVELEdBQ2ZzQixFQUF3QixFQUFqQjdFLEVBQVF1RCxFQUFJLEdBQ25CdUIsRUFBd0IsRUFBakI5RSxFQUFRdUQsRUFBSSxHQU92QixHQU5BaUIsRUFBTyxHQUFLckQsRUFBU3lELEdBQ3JCSixFQUFPLEdBQUtyRCxFQUFTeUQsRUFBTyxHQUM1QkosRUFBTyxHQUFLckQsRUFBUzBELEdBQ3JCTCxFQUFPLEdBQUtyRCxFQUFTMEQsRUFBTyxHQUM1QkwsRUFBTyxHQUFLckQsRUFBUzJELEdBQ3JCTixFQUFPLEdBQUtyRCxFQUFTMkQsRUFBTyxHQUN4QjlGLEVBQVlxRixTQUFTdkYsRUFBVTBFLEVBQUcxRSxFQUFVMkUsR0FDNUMsT0FBTyxFQUdmLE9BQU8sR0FVWHZFLEVBQUtsQixVQUFVK0csUUFBVSxTQUFVQyxHQUMvQjdGLEVBQU9uQixVQUFVK0csUUFBUXJGLEtBQUs1QixLQUFNa0gsR0FDcENsSCxLQUFLc0IsU0FBU08sV0FDaUIsSUFBM0I3QixLQUFLc0IsU0FBU08sVUFDZDdCLEtBQUtzQixTQUFTNkYsVUFFbEJuSCxLQUFLc0IsU0FBVyxLQUNoQnRCLEtBQUt1QixPQUFTLEtBQ2R2QixLQUFLd0IsTUFBUSxLQUNieEIsS0FBS2lDLElBQU0sS0FDWGpDLEtBQUtrQyxRQUFVLEtBQ2ZsQyxLQUFLbUMsV0FBYSxNQVN0QmYsRUFBS21DLGVBQWlCLElBQ2ZuQyxFQXJZYyxDQXNZdkIsRUFBQWdHLFdBWUVDLEVBQThCLFNBQVVoRyxHQVd4QyxTQUFTZ0csRUFBYUMsRUFBVUosR0FDNUIsSUFBSXZGLEVBQVEzQixLQUNSaUUsRUFBVyxDQUNYcUQsU0FBVUEsRUFDVjVELE1BQU8sRUFDUDZELGVBQWdCLEVBQUFDLE9BQUEsU0FDaEJDLE9BQVEsSUFBSTNHLGFBQWEsQ0FBQyxFQUFHLEVBQUcsRUFBRyxLQXlDdkMsT0F0Q0FvRyxFQUFVMUgsT0FBT2tJLE9BQU8sQ0FDcEJ6RSxLQUFNLFNBQ05TLE1BQU8sRUFDUG1CLFdBQVksU0FDYnFDLElBQ1NqRCxVQUNSekUsT0FBT2tJLE9BQU96RCxFQUFVaUQsRUFBUWpELFdBRXBDdEMsRUFBUU4sRUFBT08sS0FBSzVCLEtBQU1rSCxFQUFRcEQsU0FBVyxFQUFBNkQsUUFBQSxLQXBDeEMsOFlBRkUsZ0xBc0NzRTFELElBQWFqRSxNQU9wRjRILGFBQWMsRUFPcEJqRyxFQUFNckIsU0FBVyxJQUFJLEVBQUF1SCxjQUFjUCxHQU1uQzNGLEVBQU0yQixlQUFnQ3dFLElBQXBCWixFQUFRcEQsUUFPMUJuQyxFQUFNa0QsV0FBYXFDLEVBQVFyQyxXQUMzQmxELEVBQU1zQixLQUFPaUUsRUFBUWpFLEtBQ3JCdEIsRUFBTStCLE1BQVF3RCxFQUFReEQsTUFDZi9CLEVBdUVYLE9BaElBN0IsRUFBVXVILEVBQWNoRyxHQTJEeEI3QixPQUFPaUQsZUFBZTRFLEVBQWFuSCxVQUFXLFVBQVcsQ0FLckR3QyxJQUFLLFdBQ0QsT0FBTzFDLEtBQUtpRSxTQUFTcUQsVUFFekJ4RSxJQUFLLFNBQVVDLEdBQ1AvQyxLQUFLaUUsU0FBU3FELFdBQWF2RSxJQUMzQi9DLEtBQUtpRSxTQUFTcUQsU0FBV3ZFLEVBQ3pCL0MsS0FBS00sU0FBUzRDLFFBQVVILElBR2hDSCxZQUFZLEVBQ1pDLGNBQWMsSUFFbEJyRCxPQUFPaUQsZUFBZTRFLEVBQWFuSCxVQUFXLFFBQVMsQ0FDbkR3QyxJQUFLLFdBQ0QsT0FBTzFDLEtBQUsrSCxRQVFoQmpGLElBQUssU0FBVUMsR0FDUEEsSUFBVS9DLEtBQUsrSCxTQUVuQi9ILEtBQUsrSCxPQUFTaEYsRUFDZC9DLEtBQUs0SCxhQUFjLElBRXZCaEYsWUFBWSxFQUNaQyxjQUFjLElBRWxCckQsT0FBT2lELGVBQWU0RSxFQUFhbkgsVUFBVyxPQUFRLENBQ2xEd0MsSUFBSyxXQUNELE9BQU8xQyxLQUFLZ0ksT0FPaEJsRixJQUFLLFNBQVVDLEdBQ1BBLElBQVUvQyxLQUFLZ0ksUUFFbkJoSSxLQUFLZ0ksTUFBUWpGLEVBQ2IvQyxLQUFLMkUsVUFBWTVCLEdBQVMsS0FBZSxNQUFSQSxLQUE0QixJQUFSQSxJQUFpQixJQUN0RS9DLEtBQUs0SCxhQUFjLElBRXZCaEYsWUFBWSxFQUNaQyxjQUFjLElBTWxCd0UsRUFBYW5ILFVBQVVTLE9BQVMsV0FDNUIsR0FBSVgsS0FBSzRILFlBQWEsQ0FDbEI1SCxLQUFLNEgsYUFBYyxFQUNuQixJQUFJSyxFQUFjakksS0FBS2tELFFBQVErRSxhQUMvQixJQUFBQyx1QkFBc0JsSSxLQUFLZ0ksTUFBT2hJLEtBQUsrSCxPQUFRL0gsS0FBS2lFLFNBQVN3RCxPQUFRUSxFQUFZRSxXQUVqRm5JLEtBQUtNLFNBQVNLLFdBQ2RYLEtBQUtpRSxTQUFTc0QsZUFBaUJ2SCxLQUFLTSxTQUFTOEgsV0FHOUNmLEVBaklzQixDQWtJL0IsRUFBQWdCLFFBbUJFQyxFQUE4QixTQUFVakgsR0FPeEMsU0FBU2lILEVBQWFqRixFQUFVcEIsRUFBS3NHLEdBQ2pDLElBQUk1RyxFQUFRTixFQUFPTyxLQUFLNUIsT0FBU0EsS0FDN0J3SSxFQUFpQixJQUFJLEVBQUFDLE9BQU9wRixHQUM1QnFGLEVBQVksSUFBSSxFQUFBRCxPQUFPeEcsR0FBSyxHQUM1QnlDLEVBQWMsSUFBSSxFQUFBK0QsT0FBT0YsR0FBTyxHQUFNLEdBYTFDLE9BWkE1RyxFQUFNZ0gsYUFBYSxrQkFBbUJILEVBQWdCLEdBQUcsRUFBTyxFQUFBSSxNQUFBLE9BQzNERCxhQUFhLGdCQUFpQkQsRUFBVyxHQUFHLEVBQU8sRUFBQUUsTUFBQSxPQUNuREMsU0FBU25FLEdBU2QvQyxFQUFNbUgsV0FBYSxFQUNabkgsRUFlWCxPQXRDQTdCLEVBQVV3SSxFQUFjakgsR0F5QnhCN0IsT0FBT2lELGVBQWU2RixFQUFhcEksVUFBVyxnQkFBaUIsQ0FPM0R3QyxJQUFLLFdBQ0QsT0FBTzFDLEtBQUsyQyxRQUFRLEdBQUdqQyxXQUUzQmtDLFlBQVksRUFDWkMsY0FBYyxJQUVYeUYsRUF2Q3NCLENBd0MvQixFQUFBUyIsImZpbGUiOiJmZmUyYWRiYjY4ZWE5Y2QxOTIyZS5qcyIsInNvdXJjZXNDb250ZW50IjpbIi8qIVxuICogQHBpeGkvbWVzaCAtIHY1LjMuN1xuICogQ29tcGlsZWQgVHVlLCAyOSBEZWMgMjAyMCAxOTozMDoxMSBVVENcbiAqXG4gKiBAcGl4aS9tZXNoIGlzIGxpY2Vuc2VkIHVuZGVyIHRoZSBNSVQgTGljZW5zZS5cbiAqIGh0dHA6Ly93d3cub3BlbnNvdXJjZS5vcmcvbGljZW5zZXMvbWl0LWxpY2Vuc2VcbiAqL1xuaW1wb3J0IHsgU3RhdGUsIFByb2dyYW0sIFRleHR1cmVNYXRyaXgsIFNoYWRlciwgQnVmZmVyLCBHZW9tZXRyeSB9IGZyb20gJ0BwaXhpL2NvcmUnO1xuaW1wb3J0IHsgUG9pbnQsIFBvbHlnb24sIE1hdHJpeCB9IGZyb20gJ0BwaXhpL21hdGgnO1xuaW1wb3J0IHsgRFJBV19NT0RFUywgVFlQRVMgfSBmcm9tICdAcGl4aS9jb25zdGFudHMnO1xuaW1wb3J0IHsgQ29udGFpbmVyIH0gZnJvbSAnQHBpeGkvZGlzcGxheSc7XG5pbXBvcnQgeyBzZXR0aW5ncyB9IGZyb20gJ0BwaXhpL3NldHRpbmdzJztcbmltcG9ydCB7IHByZW11bHRpcGx5VGludFRvUmdiYSB9IGZyb20gJ0BwaXhpL3V0aWxzJztcblxuLyohICoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqXHJcbkNvcHlyaWdodCAoYykgTWljcm9zb2Z0IENvcnBvcmF0aW9uLiBBbGwgcmlnaHRzIHJlc2VydmVkLlxyXG5MaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpOyB5b3UgbWF5IG5vdCB1c2VcclxudGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGVcclxuTGljZW5zZSBhdCBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcclxuXHJcblRISVMgQ09ERSBJUyBQUk9WSURFRCBPTiBBTiAqQVMgSVMqIEJBU0lTLCBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTllcclxuS0lORCwgRUlUSEVSIEVYUFJFU1MgT1IgSU1QTElFRCwgSU5DTFVESU5HIFdJVEhPVVQgTElNSVRBVElPTiBBTlkgSU1QTElFRFxyXG5XQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgVElUTEUsIEZJVE5FU1MgRk9SIEEgUEFSVElDVUxBUiBQVVJQT1NFLFxyXG5NRVJDSEFOVEFCTElUWSBPUiBOT04tSU5GUklOR0VNRU5ULlxyXG5cclxuU2VlIHRoZSBBcGFjaGUgVmVyc2lvbiAyLjAgTGljZW5zZSBmb3Igc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zXHJcbmFuZCBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cclxuKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiogKi9cclxuLyogZ2xvYmFsIFJlZmxlY3QsIFByb21pc2UgKi9cclxuXHJcbnZhciBleHRlbmRTdGF0aWNzID0gZnVuY3Rpb24oZCwgYikge1xyXG4gICAgZXh0ZW5kU3RhdGljcyA9IE9iamVjdC5zZXRQcm90b3R5cGVPZiB8fFxyXG4gICAgICAgICh7IF9fcHJvdG9fXzogW10gfSBpbnN0YW5jZW9mIEFycmF5ICYmIGZ1bmN0aW9uIChkLCBiKSB7IGQuX19wcm90b19fID0gYjsgfSkgfHxcclxuICAgICAgICBmdW5jdGlvbiAoZCwgYikgeyBmb3IgKHZhciBwIGluIGIpIHsgaWYgKGIuaGFzT3duUHJvcGVydHkocCkpIHsgZFtwXSA9IGJbcF07IH0gfSB9O1xyXG4gICAgcmV0dXJuIGV4dGVuZFN0YXRpY3MoZCwgYik7XHJcbn07XHJcblxyXG5mdW5jdGlvbiBfX2V4dGVuZHMoZCwgYikge1xyXG4gICAgZXh0ZW5kU3RhdGljcyhkLCBiKTtcclxuICAgIGZ1bmN0aW9uIF9fKCkgeyB0aGlzLmNvbnN0cnVjdG9yID0gZDsgfVxyXG4gICAgZC5wcm90b3R5cGUgPSBiID09PSBudWxsID8gT2JqZWN0LmNyZWF0ZShiKSA6IChfXy5wcm90b3R5cGUgPSBiLnByb3RvdHlwZSwgbmV3IF9fKCkpO1xyXG59XG5cbi8qKlxuICogQ2xhc3MgY29udHJvbHMgY2FjaGUgZm9yIFVWIG1hcHBpbmcgZnJvbSBUZXh0dXJlIG5vcm1hbCBzcGFjZSB0byBCYXNlVGV4dHVyZSBub3JtYWwgc3BhY2UuXG4gKlxuICogQGNsYXNzXG4gKiBAbWVtYmVyb2YgUElYSVxuICovXG52YXIgTWVzaEJhdGNoVXZzID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkge1xuICAgIC8qKlxuICAgICAqIEBwYXJhbSB7UElYSS5CdWZmZXJ9IHV2QnVmZmVyIC0gQnVmZmVyIHdpdGggbm9ybWFsaXplZCB1didzXG4gICAgICogQHBhcmFtIHtQSVhJLlRleHR1cmVNYXRyaXh9IHV2TWF0cml4IC0gTWF0ZXJpYWwgVVYgbWF0cml4XG4gICAgICovXG4gICAgZnVuY3Rpb24gTWVzaEJhdGNoVXZzKHV2QnVmZmVyLCB1dk1hdHJpeCkge1xuICAgICAgICAvKipcbiAgICAgICAgICogQnVmZmVyIHdpdGggbm9ybWFsaXplZCBVVidzXG4gICAgICAgICAqIEBtZW1iZXIge1BJWEkuQnVmZmVyfVxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy51dkJ1ZmZlciA9IHV2QnVmZmVyO1xuICAgICAgICAvKipcbiAgICAgICAgICogTWF0ZXJpYWwgVVYgbWF0cml4XG4gICAgICAgICAqIEBtZW1iZXIge1BJWEkuVGV4dHVyZU1hdHJpeH1cbiAgICAgICAgICovXG4gICAgICAgIHRoaXMudXZNYXRyaXggPSB1dk1hdHJpeDtcbiAgICAgICAgLyoqXG4gICAgICAgICAqIFVWIEJ1ZmZlciBkYXRhXG4gICAgICAgICAqIEBtZW1iZXIge0Zsb2F0MzJBcnJheX1cbiAgICAgICAgICogQHJlYWRvbmx5XG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLmRhdGEgPSBudWxsO1xuICAgICAgICB0aGlzLl9idWZmZXJVcGRhdGVJZCA9IC0xO1xuICAgICAgICB0aGlzLl90ZXh0dXJlVXBkYXRlSWQgPSAtMTtcbiAgICAgICAgdGhpcy5fdXBkYXRlSUQgPSAwO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiB1cGRhdGVzXG4gICAgICpcbiAgICAgKiBAcGFyYW0ge2Jvb2xlYW59IFtmb3JjZVVwZGF0ZV0gLSBmb3JjZSB0aGUgdXBkYXRlXG4gICAgICovXG4gICAgTWVzaEJhdGNoVXZzLnByb3RvdHlwZS51cGRhdGUgPSBmdW5jdGlvbiAoZm9yY2VVcGRhdGUpIHtcbiAgICAgICAgaWYgKCFmb3JjZVVwZGF0ZVxuICAgICAgICAgICAgJiYgdGhpcy5fYnVmZmVyVXBkYXRlSWQgPT09IHRoaXMudXZCdWZmZXIuX3VwZGF0ZUlEXG4gICAgICAgICAgICAmJiB0aGlzLl90ZXh0dXJlVXBkYXRlSWQgPT09IHRoaXMudXZNYXRyaXguX3VwZGF0ZUlEKSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5fYnVmZmVyVXBkYXRlSWQgPSB0aGlzLnV2QnVmZmVyLl91cGRhdGVJRDtcbiAgICAgICAgdGhpcy5fdGV4dHVyZVVwZGF0ZUlkID0gdGhpcy51dk1hdHJpeC5fdXBkYXRlSUQ7XG4gICAgICAgIHZhciBkYXRhID0gdGhpcy51dkJ1ZmZlci5kYXRhO1xuICAgICAgICBpZiAoIXRoaXMuZGF0YSB8fCB0aGlzLmRhdGEubGVuZ3RoICE9PSBkYXRhLmxlbmd0aCkge1xuICAgICAgICAgICAgdGhpcy5kYXRhID0gbmV3IEZsb2F0MzJBcnJheShkYXRhLmxlbmd0aCk7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy51dk1hdHJpeC5tdWx0aXBseVV2cyhkYXRhLCB0aGlzLmRhdGEpO1xuICAgICAgICB0aGlzLl91cGRhdGVJRCsrO1xuICAgIH07XG4gICAgcmV0dXJuIE1lc2hCYXRjaFV2cztcbn0oKSk7XG5cbnZhciB0ZW1wUG9pbnQgPSBuZXcgUG9pbnQoKTtcbnZhciB0ZW1wUG9seWdvbiA9IG5ldyBQb2x5Z29uKCk7XG4vKipcbiAqIEJhc2UgbWVzaCBjbGFzcy5cbiAqXG4gKiBUaGlzIGNsYXNzIGVtcG93ZXJzIHlvdSB0byBoYXZlIG1heGltdW0gZmxleGliaWxpdHkgdG8gcmVuZGVyIGFueSBraW5kIG9mIFdlYkdMIHZpc3VhbHMgeW91IGNhbiB0aGluayBvZi5cbiAqIFRoaXMgY2xhc3MgYXNzdW1lcyBhIGNlcnRhaW4gbGV2ZWwgb2YgV2ViR0wga25vd2xlZGdlLlxuICogSWYgeW91IGtub3cgYSBiaXQgdGhpcyBzaG91bGQgYWJzdHJhY3QgZW5vdWdoIGF3YXkgdG8gbWFrZSB5b3UgbGlmZSBlYXNpZXIhXG4gKlxuICogUHJldHR5IG11Y2ggQUxMIFdlYkdMIGNhbiBiZSBicm9rZW4gZG93biBpbnRvIHRoZSBmb2xsb3dpbmc6XG4gKiAtIEdlb21ldHJ5IC0gVGhlIHN0cnVjdHVyZSBhbmQgZGF0YSBmb3IgdGhlIG1lc2guIFRoaXMgY2FuIGluY2x1ZGUgYW55dGhpbmcgZnJvbSBwb3NpdGlvbnMsIHV2cywgbm9ybWFscywgY29sb3JzIGV0Yy4uXG4gKiAtIFNoYWRlciAtIFRoaXMgaXMgdGhlIHNoYWRlciB0aGF0IFBpeGlKUyB3aWxsIHJlbmRlciB0aGUgZ2VvbWV0cnkgd2l0aCAoYXR0cmlidXRlcyBpbiB0aGUgc2hhZGVyIG11c3QgbWF0Y2ggdGhlIGdlb21ldHJ5KVxuICogLSBTdGF0ZSAtIFRoaXMgaXMgdGhlIHN0YXRlIG9mIFdlYkdMIHJlcXVpcmVkIHRvIHJlbmRlciB0aGUgbWVzaC5cbiAqXG4gKiBUaHJvdWdoIGEgY29tYmluYXRpb24gb2YgdGhlIGFib3ZlIGVsZW1lbnRzIHlvdSBjYW4gcmVuZGVyIGFueXRoaW5nIHlvdSB3YW50LCAyRCBvciAzRCFcbiAqXG4gKiBAY2xhc3NcbiAqIEBleHRlbmRzIFBJWEkuQ29udGFpbmVyXG4gKiBAbWVtYmVyb2YgUElYSVxuICovXG52YXIgTWVzaCA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uIChfc3VwZXIpIHtcbiAgICBfX2V4dGVuZHMoTWVzaCwgX3N1cGVyKTtcbiAgICAvKipcbiAgICAgKiBAcGFyYW0ge1BJWEkuR2VvbWV0cnl9IGdlb21ldHJ5IC0gdGhlIGdlb21ldHJ5IHRoZSBtZXNoIHdpbGwgdXNlXG4gICAgICogQHBhcmFtIHtQSVhJLk1lc2hNYXRlcmlhbH0gc2hhZGVyIC0gdGhlIHNoYWRlciB0aGUgbWVzaCB3aWxsIHVzZVxuICAgICAqIEBwYXJhbSB7UElYSS5TdGF0ZX0gW3N0YXRlXSAtIHRoZSBzdGF0ZSB0aGF0IHRoZSBXZWJHTCBjb250ZXh0IGlzIHJlcXVpcmVkIHRvIGJlIGluIHRvIHJlbmRlciB0aGUgbWVzaFxuICAgICAqICAgICAgICBpZiBubyBzdGF0ZSBpcyBwcm92aWRlZCwgdXNlcyB7QGxpbmsgUElYSS5TdGF0ZS5mb3IyZH0gdG8gY3JlYXRlIGEgMkQgc3RhdGUgZm9yIFBpeGlKUy5cbiAgICAgKiBAcGFyYW0ge251bWJlcn0gW2RyYXdNb2RlPVBJWEkuRFJBV19NT0RFUy5UUklBTkdMRVNdIC0gdGhlIGRyYXdNb2RlLCBjYW4gYmUgYW55IG9mIHRoZSBQSVhJLkRSQVdfTU9ERVMgY29uc3RzXG4gICAgICovXG4gICAgZnVuY3Rpb24gTWVzaChnZW9tZXRyeSwgc2hhZGVyLCBzdGF0ZSwgZHJhd01vZGUpIHtcbiAgICAgICAgaWYgKGRyYXdNb2RlID09PSB2b2lkIDApIHsgZHJhd01vZGUgPSBEUkFXX01PREVTLlRSSUFOR0xFUzsgfVxuICAgICAgICB2YXIgX3RoaXMgPSBfc3VwZXIuY2FsbCh0aGlzKSB8fCB0aGlzO1xuICAgICAgICAvKipcbiAgICAgICAgICogSW5jbHVkZXMgdmVydGV4IHBvc2l0aW9ucywgZmFjZSBpbmRpY2VzLCBub3JtYWxzLCBjb2xvcnMsIFVWcywgYW5kXG4gICAgICAgICAqIGN1c3RvbSBhdHRyaWJ1dGVzIHdpdGhpbiBidWZmZXJzLCByZWR1Y2luZyB0aGUgY29zdCBvZiBwYXNzaW5nIGFsbFxuICAgICAgICAgKiB0aGlzIGRhdGEgdG8gdGhlIEdQVS4gQ2FuIGJlIHNoYXJlZCBiZXR3ZWVuIG11bHRpcGxlIE1lc2ggb2JqZWN0cy5cbiAgICAgICAgICogQG1lbWJlciB7UElYSS5HZW9tZXRyeX1cbiAgICAgICAgICogQHJlYWRvbmx5XG4gICAgICAgICAqL1xuICAgICAgICBfdGhpcy5nZW9tZXRyeSA9IGdlb21ldHJ5O1xuICAgICAgICBnZW9tZXRyeS5yZWZDb3VudCsrO1xuICAgICAgICAvKipcbiAgICAgICAgICogUmVwcmVzZW50cyB0aGUgdmVydGV4IGFuZCBmcmFnbWVudCBzaGFkZXJzIHRoYXQgcHJvY2Vzc2VzIHRoZSBnZW9tZXRyeSBhbmQgcnVucyBvbiB0aGUgR1BVLlxuICAgICAgICAgKiBDYW4gYmUgc2hhcmVkIGJldHdlZW4gbXVsdGlwbGUgTWVzaCBvYmplY3RzLlxuICAgICAgICAgKiBAbWVtYmVyIHtQSVhJLlNoYWRlcnxQSVhJLk1lc2hNYXRlcmlhbH1cbiAgICAgICAgICovXG4gICAgICAgIF90aGlzLnNoYWRlciA9IHNoYWRlcjtcbiAgICAgICAgLyoqXG4gICAgICAgICAqIFJlcHJlc2VudHMgdGhlIFdlYkdMIHN0YXRlIHRoZSBNZXNoIHJlcXVpcmVkIHRvIHJlbmRlciwgZXhjbHVkZXMgc2hhZGVyIGFuZCBnZW9tZXRyeS4gRS5nLixcbiAgICAgICAgICogYmxlbmQgbW9kZSwgY3VsbGluZywgZGVwdGggdGVzdGluZywgZGlyZWN0aW9uIG9mIHJlbmRlcmluZyB0cmlhbmdsZXMsIGJhY2tmYWNlLCBldGMuXG4gICAgICAgICAqIEBtZW1iZXIge1BJWEkuU3RhdGV9XG4gICAgICAgICAqL1xuICAgICAgICBfdGhpcy5zdGF0ZSA9IHN0YXRlIHx8IFN0YXRlLmZvcjJkKCk7XG4gICAgICAgIC8qKlxuICAgICAgICAgKiBUaGUgd2F5IHRoZSBNZXNoIHNob3VsZCBiZSBkcmF3biwgY2FuIGJlIGFueSBvZiB0aGUge0BsaW5rIFBJWEkuRFJBV19NT0RFU30gY29uc3RhbnRzLlxuICAgICAgICAgKlxuICAgICAgICAgKiBAbWVtYmVyIHtudW1iZXJ9XG4gICAgICAgICAqIEBzZWUgUElYSS5EUkFXX01PREVTXG4gICAgICAgICAqL1xuICAgICAgICBfdGhpcy5kcmF3TW9kZSA9IGRyYXdNb2RlO1xuICAgICAgICAvKipcbiAgICAgICAgICogVHlwaWNhbGx5IHRoZSBpbmRleCBvZiB0aGUgSW5kZXhCdWZmZXIgd2hlcmUgdG8gc3RhcnQgZHJhd2luZy5cbiAgICAgICAgICogQG1lbWJlciB7bnVtYmVyfVxuICAgICAgICAgKiBAZGVmYXVsdCAwXG4gICAgICAgICAqL1xuICAgICAgICBfdGhpcy5zdGFydCA9IDA7XG4gICAgICAgIC8qKlxuICAgICAgICAgKiBIb3cgbXVjaCBvZiB0aGUgZ2VvbWV0cnkgdG8gZHJhdywgYnkgZGVmYXVsdCBgMGAgcmVuZGVycyBldmVyeXRoaW5nLlxuICAgICAgICAgKiBAbWVtYmVyIHtudW1iZXJ9XG4gICAgICAgICAqIEBkZWZhdWx0IDBcbiAgICAgICAgICovXG4gICAgICAgIF90aGlzLnNpemUgPSAwO1xuICAgICAgICAvKipcbiAgICAgICAgICogdGhlYXNlIGFyZSB1c2VkIGFzIGVhc3kgYWNjZXNzIGZvciBiYXRjaGluZ1xuICAgICAgICAgKiBAbWVtYmVyIHtGbG9hdDMyQXJyYXl9XG4gICAgICAgICAqIEBwcml2YXRlXG4gICAgICAgICAqL1xuICAgICAgICBfdGhpcy51dnMgPSBudWxsO1xuICAgICAgICAvKipcbiAgICAgICAgICogdGhlYXNlIGFyZSB1c2VkIGFzIGVhc3kgYWNjZXNzIGZvciBiYXRjaGluZ1xuICAgICAgICAgKiBAbWVtYmVyIHtVaW50MTZBcnJheX1cbiAgICAgICAgICogQHByaXZhdGVcbiAgICAgICAgICovXG4gICAgICAgIF90aGlzLmluZGljZXMgPSBudWxsO1xuICAgICAgICAvKipcbiAgICAgICAgICogdGhpcyBpcyB0aGUgY2FjaGluZyBsYXllciB1c2VkIGJ5IHRoZSBiYXRjaGVyXG4gICAgICAgICAqIEBtZW1iZXIge0Zsb2F0MzJBcnJheX1cbiAgICAgICAgICogQHByaXZhdGVcbiAgICAgICAgICovXG4gICAgICAgIF90aGlzLnZlcnRleERhdGEgPSBuZXcgRmxvYXQzMkFycmF5KDEpO1xuICAgICAgICAvKipcbiAgICAgICAgICogSWYgZ2VvbWV0cnkgaXMgY2hhbmdlZCB1c2VkIHRvIGRlY2lkZSB0byByZS10cmFuc2Zvcm1cbiAgICAgICAgICogdGhlIHZlcnRleERhdGEuXG4gICAgICAgICAqIEBtZW1iZXIge251bWJlcn1cbiAgICAgICAgICogQHByaXZhdGVcbiAgICAgICAgICovXG4gICAgICAgIF90aGlzLnZlcnRleERpcnR5ID0gMDtcbiAgICAgICAgX3RoaXMuX3RyYW5zZm9ybUlEID0gLTE7XG4gICAgICAgIC8qKlxuICAgICAgICAgKiBJbnRlcm5hbCByb3VuZFBpeGVscyBmaWVsZFxuICAgICAgICAgKlxuICAgICAgICAgKiBAbWVtYmVyIHtib29sZWFufVxuICAgICAgICAgKiBAcHJpdmF0ZVxuICAgICAgICAgKi9cbiAgICAgICAgX3RoaXMuX3JvdW5kUGl4ZWxzID0gc2V0dGluZ3MuUk9VTkRfUElYRUxTO1xuICAgICAgICAvKipcbiAgICAgICAgICogQmF0Y2hlZCBVVidzIGFyZSBjYWNoZWQgZm9yIGF0bGFzIHRleHR1cmVzXG4gICAgICAgICAqIEBtZW1iZXIge1BJWEkuTWVzaEJhdGNoVXZzfVxuICAgICAgICAgKiBAcHJpdmF0ZVxuICAgICAgICAgKi9cbiAgICAgICAgX3RoaXMuYmF0Y2hVdnMgPSBudWxsO1xuICAgICAgICByZXR1cm4gX3RoaXM7XG4gICAgfVxuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShNZXNoLnByb3RvdHlwZSwgXCJ1dkJ1ZmZlclwiLCB7XG4gICAgICAgIC8qKlxuICAgICAgICAgKiBUbyBjaGFuZ2UgbWVzaCB1didzLCBjaGFuZ2UgaXRzIHV2QnVmZmVyIGRhdGEgYW5kIGluY3JlbWVudCBpdHMgX3VwZGF0ZUlELlxuICAgICAgICAgKiBAbWVtYmVyIHtQSVhJLkJ1ZmZlcn1cbiAgICAgICAgICogQHJlYWRvbmx5XG4gICAgICAgICAqL1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLmdlb21ldHJ5LmJ1ZmZlcnNbMV07XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IGZhbHNlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoTWVzaC5wcm90b3R5cGUsIFwidmVydGljZXNCdWZmZXJcIiwge1xuICAgICAgICAvKipcbiAgICAgICAgICogVG8gY2hhbmdlIG1lc2ggdmVydGljZXMsIGNoYW5nZSBpdHMgdXZCdWZmZXIgZGF0YSBhbmQgaW5jcmVtZW50IGl0cyBfdXBkYXRlSUQuXG4gICAgICAgICAqIEluY3JlbWVudGluZyBfdXBkYXRlSUQgaXMgb3B0aW9uYWwgYmVjYXVzZSBtb3N0IG9mIE1lc2ggb2JqZWN0cyBkbyBpdCBhbnl3YXkuXG4gICAgICAgICAqIEBtZW1iZXIge1BJWEkuQnVmZmVyfVxuICAgICAgICAgKiBAcmVhZG9ubHlcbiAgICAgICAgICovXG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuZ2VvbWV0cnkuYnVmZmVyc1swXTtcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogZmFsc2UsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShNZXNoLnByb3RvdHlwZSwgXCJtYXRlcmlhbFwiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuc2hhZGVyO1xuICAgICAgICB9LFxuICAgICAgICAvKipcbiAgICAgICAgICogQWxpYXMgZm9yIHtAbGluayBQSVhJLk1lc2gjc2hhZGVyfS5cbiAgICAgICAgICogQG1lbWJlciB7UElYSS5NZXNoTWF0ZXJpYWx9XG4gICAgICAgICAqL1xuICAgICAgICBzZXQ6IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICAgICAgdGhpcy5zaGFkZXIgPSB2YWx1ZTtcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogZmFsc2UsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShNZXNoLnByb3RvdHlwZSwgXCJibGVuZE1vZGVcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLnN0YXRlLmJsZW5kTW9kZTtcbiAgICAgICAgfSxcbiAgICAgICAgLyoqXG4gICAgICAgICAqIFRoZSBibGVuZCBtb2RlIHRvIGJlIGFwcGxpZWQgdG8gdGhlIE1lc2guIEFwcGx5IGEgdmFsdWUgb2ZcbiAgICAgICAgICogYFBJWEkuQkxFTkRfTU9ERVMuTk9STUFMYCB0byByZXNldCB0aGUgYmxlbmQgbW9kZS5cbiAgICAgICAgICpcbiAgICAgICAgICogQG1lbWJlciB7bnVtYmVyfVxuICAgICAgICAgKiBAZGVmYXVsdCBQSVhJLkJMRU5EX01PREVTLk5PUk1BTDtcbiAgICAgICAgICogQHNlZSBQSVhJLkJMRU5EX01PREVTXG4gICAgICAgICAqL1xuICAgICAgICBzZXQ6IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICAgICAgdGhpcy5zdGF0ZS5ibGVuZE1vZGUgPSB2YWx1ZTtcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogZmFsc2UsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShNZXNoLnByb3RvdHlwZSwgXCJyb3VuZFBpeGVsc1wiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuX3JvdW5kUGl4ZWxzO1xuICAgICAgICB9LFxuICAgICAgICAvKipcbiAgICAgICAgICogSWYgdHJ1ZSBQaXhpSlMgd2lsbCBNYXRoLmZsb29yKCkgeC95IHZhbHVlcyB3aGVuIHJlbmRlcmluZywgc3RvcHBpbmcgcGl4ZWwgaW50ZXJwb2xhdGlvbi5cbiAgICAgICAgICogQWR2YW50YWdlcyBjYW4gaW5jbHVkZSBzaGFycGVyIGltYWdlIHF1YWxpdHkgKGxpa2UgdGV4dCkgYW5kIGZhc3RlciByZW5kZXJpbmcgb24gY2FudmFzLlxuICAgICAgICAgKiBUaGUgbWFpbiBkaXNhZHZhbnRhZ2UgaXMgbW92ZW1lbnQgb2Ygb2JqZWN0cyBtYXkgYXBwZWFyIGxlc3Mgc21vb3RoLlxuICAgICAgICAgKiBUbyBzZXQgdGhlIGdsb2JhbCBkZWZhdWx0LCBjaGFuZ2Uge0BsaW5rIFBJWEkuc2V0dGluZ3MuUk9VTkRfUElYRUxTfVxuICAgICAgICAgKlxuICAgICAgICAgKiBAbWVtYmVyIHtib29sZWFufVxuICAgICAgICAgKiBAZGVmYXVsdCBmYWxzZVxuICAgICAgICAgKi9cbiAgICAgICAgc2V0OiBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgICAgIGlmICh0aGlzLl9yb3VuZFBpeGVscyAhPT0gdmFsdWUpIHtcbiAgICAgICAgICAgICAgICB0aGlzLl90cmFuc2Zvcm1JRCA9IC0xO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdGhpcy5fcm91bmRQaXhlbHMgPSB2YWx1ZTtcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogZmFsc2UsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShNZXNoLnByb3RvdHlwZSwgXCJ0aW50XCIsIHtcbiAgICAgICAgLyoqXG4gICAgICAgICAqIFRoZSBtdWx0aXBseSB0aW50IGFwcGxpZWQgdG8gdGhlIE1lc2guIFRoaXMgaXMgYSBoZXggdmFsdWUuIEEgdmFsdWUgb2ZcbiAgICAgICAgICogYDB4RkZGRkZGYCB3aWxsIHJlbW92ZSBhbnkgdGludCBlZmZlY3QuXG4gICAgICAgICAqXG4gICAgICAgICAqIEBtZW1iZXIge251bWJlcn1cbiAgICAgICAgICogQGRlZmF1bHQgMHhGRkZGRkZcbiAgICAgICAgICovXG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuc2hhZGVyLnRpbnQ7XG4gICAgICAgIH0sXG4gICAgICAgIHNldDogZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgICAgICB0aGlzLnNoYWRlci50aW50ID0gdmFsdWU7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IGZhbHNlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoTWVzaC5wcm90b3R5cGUsIFwidGV4dHVyZVwiLCB7XG4gICAgICAgIC8qKlxuICAgICAgICAgKiBUaGUgdGV4dHVyZSB0aGF0IHRoZSBNZXNoIHVzZXMuXG4gICAgICAgICAqXG4gICAgICAgICAqIEBtZW1iZXIge1BJWEkuVGV4dHVyZX1cbiAgICAgICAgICovXG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuc2hhZGVyLnRleHR1cmU7XG4gICAgICAgIH0sXG4gICAgICAgIHNldDogZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgICAgICB0aGlzLnNoYWRlci50ZXh0dXJlID0gdmFsdWU7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IGZhbHNlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICAvKipcbiAgICAgKiBTdGFuZGFyZCByZW5kZXJlciBkcmF3LlxuICAgICAqIEBwcm90ZWN0ZWRcbiAgICAgKiBAcGFyYW0ge1BJWEkuUmVuZGVyZXJ9IHJlbmRlcmVyIC0gSW5zdGFuY2UgdG8gcmVuZGVyZXIuXG4gICAgICovXG4gICAgTWVzaC5wcm90b3R5cGUuX3JlbmRlciA9IGZ1bmN0aW9uIChyZW5kZXJlcikge1xuICAgICAgICAvLyBzZXQgcHJvcGVydGllcyBmb3IgYmF0Y2hpbmcuLlxuICAgICAgICAvLyBUT0RPIGNvdWxkIHVzZSBhIGRpZmZlcmVudCB3YXkgdG8gZ3JhYiB2ZXJ0cz9cbiAgICAgICAgdmFyIHZlcnRpY2VzID0gdGhpcy5nZW9tZXRyeS5idWZmZXJzWzBdLmRhdGE7XG4gICAgICAgIC8vIFRPRE8gYmVuY2htYXJrIGNoZWNrIGZvciBhdHRyaWJ1dGUgc2l6ZS4uXG4gICAgICAgIGlmICh0aGlzLnNoYWRlci5iYXRjaGFibGVcbiAgICAgICAgICAgICYmIHRoaXMuZHJhd01vZGUgPT09IERSQVdfTU9ERVMuVFJJQU5HTEVTXG4gICAgICAgICAgICAmJiB2ZXJ0aWNlcy5sZW5ndGggPCBNZXNoLkJBVENIQUJMRV9TSVpFICogMikge1xuICAgICAgICAgICAgdGhpcy5fcmVuZGVyVG9CYXRjaChyZW5kZXJlcik7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICB0aGlzLl9yZW5kZXJEZWZhdWx0KHJlbmRlcmVyKTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgLyoqXG4gICAgICogU3RhbmRhcmQgbm9uLWJhdGNoaW5nIHdheSBvZiByZW5kZXJpbmcuXG4gICAgICogQHByb3RlY3RlZFxuICAgICAqIEBwYXJhbSB7UElYSS5SZW5kZXJlcn0gcmVuZGVyZXIgLSBJbnN0YW5jZSB0byByZW5kZXJlci5cbiAgICAgKi9cbiAgICBNZXNoLnByb3RvdHlwZS5fcmVuZGVyRGVmYXVsdCA9IGZ1bmN0aW9uIChyZW5kZXJlcikge1xuICAgICAgICB2YXIgc2hhZGVyID0gdGhpcy5zaGFkZXI7XG4gICAgICAgIHNoYWRlci5hbHBoYSA9IHRoaXMud29ybGRBbHBoYTtcbiAgICAgICAgaWYgKHNoYWRlci51cGRhdGUpIHtcbiAgICAgICAgICAgIHNoYWRlci51cGRhdGUoKTtcbiAgICAgICAgfVxuICAgICAgICByZW5kZXJlci5iYXRjaC5mbHVzaCgpO1xuICAgICAgICBpZiAoc2hhZGVyLnByb2dyYW0udW5pZm9ybURhdGEudHJhbnNsYXRpb25NYXRyaXgpIHtcbiAgICAgICAgICAgIHNoYWRlci51bmlmb3Jtcy50cmFuc2xhdGlvbk1hdHJpeCA9IHRoaXMudHJhbnNmb3JtLndvcmxkVHJhbnNmb3JtLnRvQXJyYXkodHJ1ZSk7XG4gICAgICAgIH1cbiAgICAgICAgLy8gYmluZCBhbmQgc3luYyB1bmlmb3Jtcy4uXG4gICAgICAgIHJlbmRlcmVyLnNoYWRlci5iaW5kKHNoYWRlcik7XG4gICAgICAgIC8vIHNldCBzdGF0ZS4uXG4gICAgICAgIHJlbmRlcmVyLnN0YXRlLnNldCh0aGlzLnN0YXRlKTtcbiAgICAgICAgLy8gYmluZCB0aGUgZ2VvbWV0cnkuLi5cbiAgICAgICAgcmVuZGVyZXIuZ2VvbWV0cnkuYmluZCh0aGlzLmdlb21ldHJ5LCBzaGFkZXIpO1xuICAgICAgICAvLyB0aGVuIHJlbmRlciBpdFxuICAgICAgICByZW5kZXJlci5nZW9tZXRyeS5kcmF3KHRoaXMuZHJhd01vZGUsIHRoaXMuc2l6ZSwgdGhpcy5zdGFydCwgdGhpcy5nZW9tZXRyeS5pbnN0YW5jZUNvdW50KTtcbiAgICB9O1xuICAgIC8qKlxuICAgICAqIFJlbmRlcmluZyBieSB1c2luZyB0aGUgQmF0Y2ggc3lzdGVtLlxuICAgICAqIEBwcm90ZWN0ZWRcbiAgICAgKiBAcGFyYW0ge1BJWEkuUmVuZGVyZXJ9IHJlbmRlcmVyIC0gSW5zdGFuY2UgdG8gcmVuZGVyZXIuXG4gICAgICovXG4gICAgTWVzaC5wcm90b3R5cGUuX3JlbmRlclRvQmF0Y2ggPSBmdW5jdGlvbiAocmVuZGVyZXIpIHtcbiAgICAgICAgdmFyIGdlb21ldHJ5ID0gdGhpcy5nZW9tZXRyeTtcbiAgICAgICAgaWYgKHRoaXMuc2hhZGVyLnV2TWF0cml4KSB7XG4gICAgICAgICAgICB0aGlzLnNoYWRlci51dk1hdHJpeC51cGRhdGUoKTtcbiAgICAgICAgICAgIHRoaXMuY2FsY3VsYXRlVXZzKCk7XG4gICAgICAgIH1cbiAgICAgICAgLy8gc2V0IHByb3BlcnRpZXMgZm9yIGJhdGNoaW5nLi5cbiAgICAgICAgdGhpcy5jYWxjdWxhdGVWZXJ0aWNlcygpO1xuICAgICAgICB0aGlzLmluZGljZXMgPSBnZW9tZXRyeS5pbmRleEJ1ZmZlci5kYXRhO1xuICAgICAgICB0aGlzLl90aW50UkdCID0gdGhpcy5zaGFkZXIuX3RpbnRSR0I7XG4gICAgICAgIHRoaXMuX3RleHR1cmUgPSB0aGlzLnNoYWRlci50ZXh0dXJlO1xuICAgICAgICB2YXIgcGx1Z2luTmFtZSA9IHRoaXMubWF0ZXJpYWwucGx1Z2luTmFtZTtcbiAgICAgICAgcmVuZGVyZXIuYmF0Y2guc2V0T2JqZWN0UmVuZGVyZXIocmVuZGVyZXIucGx1Z2luc1twbHVnaW5OYW1lXSk7XG4gICAgICAgIHJlbmRlcmVyLnBsdWdpbnNbcGx1Z2luTmFtZV0ucmVuZGVyKHRoaXMpO1xuICAgIH07XG4gICAgLyoqXG4gICAgICogVXBkYXRlcyB2ZXJ0ZXhEYXRhIGZpZWxkIGJhc2VkIG9uIHRyYW5zZm9ybSBhbmQgdmVydGljZXNcbiAgICAgKi9cbiAgICBNZXNoLnByb3RvdHlwZS5jYWxjdWxhdGVWZXJ0aWNlcyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIGdlb21ldHJ5ID0gdGhpcy5nZW9tZXRyeTtcbiAgICAgICAgdmFyIHZlcnRpY2VzID0gZ2VvbWV0cnkuYnVmZmVyc1swXS5kYXRhO1xuICAgICAgICBpZiAoZ2VvbWV0cnkudmVydGV4RGlydHlJZCA9PT0gdGhpcy52ZXJ0ZXhEaXJ0eSAmJiB0aGlzLl90cmFuc2Zvcm1JRCA9PT0gdGhpcy50cmFuc2Zvcm0uX3dvcmxkSUQpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLl90cmFuc2Zvcm1JRCA9IHRoaXMudHJhbnNmb3JtLl93b3JsZElEO1xuICAgICAgICBpZiAodGhpcy52ZXJ0ZXhEYXRhLmxlbmd0aCAhPT0gdmVydGljZXMubGVuZ3RoKSB7XG4gICAgICAgICAgICB0aGlzLnZlcnRleERhdGEgPSBuZXcgRmxvYXQzMkFycmF5KHZlcnRpY2VzLmxlbmd0aCk7XG4gICAgICAgIH1cbiAgICAgICAgdmFyIHd0ID0gdGhpcy50cmFuc2Zvcm0ud29ybGRUcmFuc2Zvcm07XG4gICAgICAgIHZhciBhID0gd3QuYTtcbiAgICAgICAgdmFyIGIgPSB3dC5iO1xuICAgICAgICB2YXIgYyA9IHd0LmM7XG4gICAgICAgIHZhciBkID0gd3QuZDtcbiAgICAgICAgdmFyIHR4ID0gd3QudHg7XG4gICAgICAgIHZhciB0eSA9IHd0LnR5O1xuICAgICAgICB2YXIgdmVydGV4RGF0YSA9IHRoaXMudmVydGV4RGF0YTtcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB2ZXJ0ZXhEYXRhLmxlbmd0aCAvIDI7IGkrKykge1xuICAgICAgICAgICAgdmFyIHggPSB2ZXJ0aWNlc1soaSAqIDIpXTtcbiAgICAgICAgICAgIHZhciB5ID0gdmVydGljZXNbKGkgKiAyKSArIDFdO1xuICAgICAgICAgICAgdmVydGV4RGF0YVsoaSAqIDIpXSA9IChhICogeCkgKyAoYyAqIHkpICsgdHg7XG4gICAgICAgICAgICB2ZXJ0ZXhEYXRhWyhpICogMikgKyAxXSA9IChiICogeCkgKyAoZCAqIHkpICsgdHk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRoaXMuX3JvdW5kUGl4ZWxzKSB7XG4gICAgICAgICAgICB2YXIgcmVzb2x1dGlvbiA9IHNldHRpbmdzLlJFU09MVVRJT047XG4gICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHZlcnRleERhdGEubGVuZ3RoOyArK2kpIHtcbiAgICAgICAgICAgICAgICB2ZXJ0ZXhEYXRhW2ldID0gTWF0aC5yb3VuZCgodmVydGV4RGF0YVtpXSAqIHJlc29sdXRpb24gfCAwKSAvIHJlc29sdXRpb24pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHRoaXMudmVydGV4RGlydHkgPSBnZW9tZXRyeS52ZXJ0ZXhEaXJ0eUlkO1xuICAgIH07XG4gICAgLyoqXG4gICAgICogVXBkYXRlcyB1diBmaWVsZCBiYXNlZCBvbiBmcm9tIGdlb21ldHJ5IHV2J3Mgb3IgYmF0Y2hVdnNcbiAgICAgKi9cbiAgICBNZXNoLnByb3RvdHlwZS5jYWxjdWxhdGVVdnMgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBnZW9tVXZzID0gdGhpcy5nZW9tZXRyeS5idWZmZXJzWzFdO1xuICAgICAgICBpZiAoIXRoaXMuc2hhZGVyLnV2TWF0cml4LmlzU2ltcGxlKSB7XG4gICAgICAgICAgICBpZiAoIXRoaXMuYmF0Y2hVdnMpIHtcbiAgICAgICAgICAgICAgICB0aGlzLmJhdGNoVXZzID0gbmV3IE1lc2hCYXRjaFV2cyhnZW9tVXZzLCB0aGlzLnNoYWRlci51dk1hdHJpeCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0aGlzLmJhdGNoVXZzLnVwZGF0ZSgpO1xuICAgICAgICAgICAgdGhpcy51dnMgPSB0aGlzLmJhdGNoVXZzLmRhdGE7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICB0aGlzLnV2cyA9IGdlb21VdnMuZGF0YTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgLyoqXG4gICAgICogVXBkYXRlcyB0aGUgYm91bmRzIG9mIHRoZSBtZXNoIGFzIGEgcmVjdGFuZ2xlLiBUaGUgYm91bmRzIGNhbGN1bGF0aW9uIHRha2VzIHRoZSB3b3JsZFRyYW5zZm9ybSBpbnRvIGFjY291bnQuXG4gICAgICogdGhlcmUgbXVzdCBiZSBhIGFWZXJ0ZXhQb3NpdGlvbiBhdHRyaWJ1dGUgcHJlc2VudCBpbiB0aGUgZ2VvbWV0cnkgZm9yIGJvdW5kcyB0byBiZSBjYWxjdWxhdGVkIGNvcnJlY3RseS5cbiAgICAgKlxuICAgICAqIEBwcm90ZWN0ZWRcbiAgICAgKi9cbiAgICBNZXNoLnByb3RvdHlwZS5fY2FsY3VsYXRlQm91bmRzID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB0aGlzLmNhbGN1bGF0ZVZlcnRpY2VzKCk7XG4gICAgICAgIHRoaXMuX2JvdW5kcy5hZGRWZXJ0ZXhEYXRhKHRoaXMudmVydGV4RGF0YSwgMCwgdGhpcy52ZXJ0ZXhEYXRhLmxlbmd0aCk7XG4gICAgfTtcbiAgICAvKipcbiAgICAgKiBUZXN0cyBpZiBhIHBvaW50IGlzIGluc2lkZSB0aGlzIG1lc2guIFdvcmtzIG9ubHkgZm9yIFBJWEkuRFJBV19NT0RFUy5UUklBTkdMRVMuXG4gICAgICpcbiAgICAgKiBAcGFyYW0ge1BJWEkuSVBvaW50RGF0YX0gcG9pbnQgLSB0aGUgcG9pbnQgdG8gdGVzdFxuICAgICAqIEByZXR1cm4ge2Jvb2xlYW59IHRoZSByZXN1bHQgb2YgdGhlIHRlc3RcbiAgICAgKi9cbiAgICBNZXNoLnByb3RvdHlwZS5jb250YWluc1BvaW50ID0gZnVuY3Rpb24gKHBvaW50KSB7XG4gICAgICAgIGlmICghdGhpcy5nZXRCb3VuZHMoKS5jb250YWlucyhwb2ludC54LCBwb2ludC55KSkge1xuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMud29ybGRUcmFuc2Zvcm0uYXBwbHlJbnZlcnNlKHBvaW50LCB0ZW1wUG9pbnQpO1xuICAgICAgICB2YXIgdmVydGljZXMgPSB0aGlzLmdlb21ldHJ5LmdldEJ1ZmZlcignYVZlcnRleFBvc2l0aW9uJykuZGF0YTtcbiAgICAgICAgdmFyIHBvaW50cyA9IHRlbXBQb2x5Z29uLnBvaW50cztcbiAgICAgICAgdmFyIGluZGljZXMgPSB0aGlzLmdlb21ldHJ5LmdldEluZGV4KCkuZGF0YTtcbiAgICAgICAgdmFyIGxlbiA9IGluZGljZXMubGVuZ3RoO1xuICAgICAgICB2YXIgc3RlcCA9IHRoaXMuZHJhd01vZGUgPT09IDQgPyAzIDogMTtcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgKyAyIDwgbGVuOyBpICs9IHN0ZXApIHtcbiAgICAgICAgICAgIHZhciBpbmQwID0gaW5kaWNlc1tpXSAqIDI7XG4gICAgICAgICAgICB2YXIgaW5kMSA9IGluZGljZXNbaSArIDFdICogMjtcbiAgICAgICAgICAgIHZhciBpbmQyID0gaW5kaWNlc1tpICsgMl0gKiAyO1xuICAgICAgICAgICAgcG9pbnRzWzBdID0gdmVydGljZXNbaW5kMF07XG4gICAgICAgICAgICBwb2ludHNbMV0gPSB2ZXJ0aWNlc1tpbmQwICsgMV07XG4gICAgICAgICAgICBwb2ludHNbMl0gPSB2ZXJ0aWNlc1tpbmQxXTtcbiAgICAgICAgICAgIHBvaW50c1szXSA9IHZlcnRpY2VzW2luZDEgKyAxXTtcbiAgICAgICAgICAgIHBvaW50c1s0XSA9IHZlcnRpY2VzW2luZDJdO1xuICAgICAgICAgICAgcG9pbnRzWzVdID0gdmVydGljZXNbaW5kMiArIDFdO1xuICAgICAgICAgICAgaWYgKHRlbXBQb2x5Z29uLmNvbnRhaW5zKHRlbXBQb2ludC54LCB0ZW1wUG9pbnQueSkpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgfTtcbiAgICAvKipcbiAgICAgKiBEZXN0cm95cyB0aGUgTWVzaCBvYmplY3QuXG4gICAgICpcbiAgICAgKiBAcGFyYW0ge29iamVjdHxib29sZWFufSBbb3B0aW9uc10gLSBPcHRpb25zIHBhcmFtZXRlci4gQSBib29sZWFuIHdpbGwgYWN0IGFzIGlmIGFsbFxuICAgICAqICBvcHRpb25zIGhhdmUgYmVlbiBzZXQgdG8gdGhhdCB2YWx1ZVxuICAgICAqIEBwYXJhbSB7Ym9vbGVhbn0gW29wdGlvbnMuY2hpbGRyZW49ZmFsc2VdIC0gaWYgc2V0IHRvIHRydWUsIGFsbCB0aGUgY2hpbGRyZW4gd2lsbCBoYXZlXG4gICAgICogIHRoZWlyIGRlc3Ryb3kgbWV0aG9kIGNhbGxlZCBhcyB3ZWxsLiAnb3B0aW9ucycgd2lsbCBiZSBwYXNzZWQgb24gdG8gdGhvc2UgY2FsbHMuXG4gICAgICovXG4gICAgTWVzaC5wcm90b3R5cGUuZGVzdHJveSA9IGZ1bmN0aW9uIChvcHRpb25zKSB7XG4gICAgICAgIF9zdXBlci5wcm90b3R5cGUuZGVzdHJveS5jYWxsKHRoaXMsIG9wdGlvbnMpO1xuICAgICAgICB0aGlzLmdlb21ldHJ5LnJlZkNvdW50LS07XG4gICAgICAgIGlmICh0aGlzLmdlb21ldHJ5LnJlZkNvdW50ID09PSAwKSB7XG4gICAgICAgICAgICB0aGlzLmdlb21ldHJ5LmRpc3Bvc2UoKTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLmdlb21ldHJ5ID0gbnVsbDtcbiAgICAgICAgdGhpcy5zaGFkZXIgPSBudWxsO1xuICAgICAgICB0aGlzLnN0YXRlID0gbnVsbDtcbiAgICAgICAgdGhpcy51dnMgPSBudWxsO1xuICAgICAgICB0aGlzLmluZGljZXMgPSBudWxsO1xuICAgICAgICB0aGlzLnZlcnRleERhdGEgPSBudWxsO1xuICAgIH07XG4gICAgLyoqXG4gICAgICogVGhlIG1heGltdW0gbnVtYmVyIG9mIHZlcnRpY2VzIHRvIGNvbnNpZGVyIGJhdGNoYWJsZS4gR2VuZXJhbGx5LCB0aGUgY29tcGxleGl0eVxuICAgICAqIG9mIHRoZSBnZW9tZXRyeS5cbiAgICAgKiBAbWVtYmVyb2YgUElYSS5NZXNoXG4gICAgICogQHN0YXRpY1xuICAgICAqIEBtZW1iZXIge251bWJlcn0gQkFUQ0hBQkxFX1NJWkVcbiAgICAgKi9cbiAgICBNZXNoLkJBVENIQUJMRV9TSVpFID0gMTAwO1xuICAgIHJldHVybiBNZXNoO1xufShDb250YWluZXIpKTtcblxudmFyIGZyYWdtZW50ID0gXCJ2YXJ5aW5nIHZlYzIgdlRleHR1cmVDb29yZDtcXG51bmlmb3JtIHZlYzQgdUNvbG9yO1xcblxcbnVuaWZvcm0gc2FtcGxlcjJEIHVTYW1wbGVyO1xcblxcbnZvaWQgbWFpbih2b2lkKVxcbntcXG4gICAgZ2xfRnJhZ0NvbG9yID0gdGV4dHVyZTJEKHVTYW1wbGVyLCB2VGV4dHVyZUNvb3JkKSAqIHVDb2xvcjtcXG59XFxuXCI7XG5cbnZhciB2ZXJ0ZXggPSBcImF0dHJpYnV0ZSB2ZWMyIGFWZXJ0ZXhQb3NpdGlvbjtcXG5hdHRyaWJ1dGUgdmVjMiBhVGV4dHVyZUNvb3JkO1xcblxcbnVuaWZvcm0gbWF0MyBwcm9qZWN0aW9uTWF0cml4O1xcbnVuaWZvcm0gbWF0MyB0cmFuc2xhdGlvbk1hdHJpeDtcXG51bmlmb3JtIG1hdDMgdVRleHR1cmVNYXRyaXg7XFxuXFxudmFyeWluZyB2ZWMyIHZUZXh0dXJlQ29vcmQ7XFxuXFxudm9pZCBtYWluKHZvaWQpXFxue1xcbiAgICBnbF9Qb3NpdGlvbiA9IHZlYzQoKHByb2plY3Rpb25NYXRyaXggKiB0cmFuc2xhdGlvbk1hdHJpeCAqIHZlYzMoYVZlcnRleFBvc2l0aW9uLCAxLjApKS54eSwgMC4wLCAxLjApO1xcblxcbiAgICB2VGV4dHVyZUNvb3JkID0gKHVUZXh0dXJlTWF0cml4ICogdmVjMyhhVGV4dHVyZUNvb3JkLCAxLjApKS54eTtcXG59XFxuXCI7XG5cbi8qKlxuICogU2xpZ2h0bHkgb3BpbmlvbmF0ZWQgZGVmYXVsdCBzaGFkZXIgZm9yIFBpeGlKUyAyRCBvYmplY3RzLlxuICogQGNsYXNzXG4gKiBAbWVtYmVyb2YgUElYSVxuICogQGV4dGVuZHMgUElYSS5TaGFkZXJcbiAqL1xudmFyIE1lc2hNYXRlcmlhbCA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uIChfc3VwZXIpIHtcbiAgICBfX2V4dGVuZHMoTWVzaE1hdGVyaWFsLCBfc3VwZXIpO1xuICAgIC8qKlxuICAgICAqIEBwYXJhbSB7UElYSS5UZXh0dXJlfSB1U2FtcGxlciAtIFRleHR1cmUgdGhhdCBtYXRlcmlhbCB1c2VzIHRvIHJlbmRlci5cbiAgICAgKiBAcGFyYW0ge29iamVjdH0gW29wdGlvbnNdIC0gQWRkaXRpb25hbCBvcHRpb25zXG4gICAgICogQHBhcmFtIHtudW1iZXJ9IFtvcHRpb25zLmFscGhhPTFdIC0gRGVmYXVsdCBhbHBoYS5cbiAgICAgKiBAcGFyYW0ge251bWJlcn0gW29wdGlvbnMudGludD0weEZGRkZGRl0gLSBEZWZhdWx0IHRpbnQuXG4gICAgICogQHBhcmFtIHtzdHJpbmd9IFtvcHRpb25zLnBsdWdpbk5hbWU9J2JhdGNoJ10gLSBSZW5kZXJlciBwbHVnaW4gZm9yIGJhdGNoaW5nLlxuICAgICAqIEBwYXJhbSB7UElYSS5Qcm9ncmFtfSBbb3B0aW9ucy5wcm9ncmFtPTB4RkZGRkZGXSAtIEN1c3RvbSBwcm9ncmFtLlxuICAgICAqIEBwYXJhbSB7b2JqZWN0fSBbb3B0aW9ucy51bmlmb3Jtc10gLSBDdXN0b20gdW5pZm9ybXMuXG4gICAgICovXG4gICAgZnVuY3Rpb24gTWVzaE1hdGVyaWFsKHVTYW1wbGVyLCBvcHRpb25zKSB7XG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgICAgIHZhciB1bmlmb3JtcyA9IHtcbiAgICAgICAgICAgIHVTYW1wbGVyOiB1U2FtcGxlcixcbiAgICAgICAgICAgIGFscGhhOiAxLFxuICAgICAgICAgICAgdVRleHR1cmVNYXRyaXg6IE1hdHJpeC5JREVOVElUWSxcbiAgICAgICAgICAgIHVDb2xvcjogbmV3IEZsb2F0MzJBcnJheShbMSwgMSwgMSwgMV0pLFxuICAgICAgICB9O1xuICAgICAgICAvLyBTZXQgZGVmYXVsdHNcbiAgICAgICAgb3B0aW9ucyA9IE9iamVjdC5hc3NpZ24oe1xuICAgICAgICAgICAgdGludDogMHhGRkZGRkYsXG4gICAgICAgICAgICBhbHBoYTogMSxcbiAgICAgICAgICAgIHBsdWdpbk5hbWU6ICdiYXRjaCcsXG4gICAgICAgIH0sIG9wdGlvbnMpO1xuICAgICAgICBpZiAob3B0aW9ucy51bmlmb3Jtcykge1xuICAgICAgICAgICAgT2JqZWN0LmFzc2lnbih1bmlmb3Jtcywgb3B0aW9ucy51bmlmb3Jtcyk7XG4gICAgICAgIH1cbiAgICAgICAgX3RoaXMgPSBfc3VwZXIuY2FsbCh0aGlzLCBvcHRpb25zLnByb2dyYW0gfHwgUHJvZ3JhbS5mcm9tKHZlcnRleCwgZnJhZ21lbnQpLCB1bmlmb3JtcykgfHwgdGhpcztcbiAgICAgICAgLyoqXG4gICAgICAgICAqIE9ubHkgZG8gdXBkYXRlIGlmIHRpbnQgb3IgYWxwaGEgY2hhbmdlcy5cbiAgICAgICAgICogQG1lbWJlciB7Ym9vbGVhbn1cbiAgICAgICAgICogQHByaXZhdGVcbiAgICAgICAgICogQGRlZmF1bHQgZmFsc2VcbiAgICAgICAgICovXG4gICAgICAgIF90aGlzLl9jb2xvckRpcnR5ID0gZmFsc2U7XG4gICAgICAgIC8qKlxuICAgICAgICAgKiBUZXh0dXJlTWF0cml4IGluc3RhbmNlIGZvciB0aGlzIE1lc2gsIHVzZWQgdG8gdHJhY2sgVGV4dHVyZSBjaGFuZ2VzXG4gICAgICAgICAqXG4gICAgICAgICAqIEBtZW1iZXIge1BJWEkuVGV4dHVyZU1hdHJpeH1cbiAgICAgICAgICogQHJlYWRvbmx5XG4gICAgICAgICAqL1xuICAgICAgICBfdGhpcy51dk1hdHJpeCA9IG5ldyBUZXh0dXJlTWF0cml4KHVTYW1wbGVyKTtcbiAgICAgICAgLyoqXG4gICAgICAgICAqIGB0cnVlYCBpZiBzaGFkZXIgY2FuIGJlIGJhdGNoIHdpdGggdGhlIHJlbmRlcmVyJ3MgYmF0Y2ggc3lzdGVtLlxuICAgICAgICAgKiBAbWVtYmVyIHtib29sZWFufVxuICAgICAgICAgKiBAZGVmYXVsdCB0cnVlXG4gICAgICAgICAqL1xuICAgICAgICBfdGhpcy5iYXRjaGFibGUgPSBvcHRpb25zLnByb2dyYW0gPT09IHVuZGVmaW5lZDtcbiAgICAgICAgLyoqXG4gICAgICAgICAqIFJlbmRlcmVyIHBsdWdpbiBmb3IgYmF0Y2hpbmdcbiAgICAgICAgICpcbiAgICAgICAgICogQG1lbWJlciB7c3RyaW5nfVxuICAgICAgICAgKiBAZGVmYXVsdCAnYmF0Y2gnXG4gICAgICAgICAqL1xuICAgICAgICBfdGhpcy5wbHVnaW5OYW1lID0gb3B0aW9ucy5wbHVnaW5OYW1lO1xuICAgICAgICBfdGhpcy50aW50ID0gb3B0aW9ucy50aW50O1xuICAgICAgICBfdGhpcy5hbHBoYSA9IG9wdGlvbnMuYWxwaGE7XG4gICAgICAgIHJldHVybiBfdGhpcztcbiAgICB9XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KE1lc2hNYXRlcmlhbC5wcm90b3R5cGUsIFwidGV4dHVyZVwiLCB7XG4gICAgICAgIC8qKlxuICAgICAgICAgKiBSZWZlcmVuY2UgdG8gdGhlIHRleHR1cmUgYmVpbmcgcmVuZGVyZWQuXG4gICAgICAgICAqIEBtZW1iZXIge1BJWEkuVGV4dHVyZX1cbiAgICAgICAgICovXG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMudW5pZm9ybXMudVNhbXBsZXI7XG4gICAgICAgIH0sXG4gICAgICAgIHNldDogZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgICAgICBpZiAodGhpcy51bmlmb3Jtcy51U2FtcGxlciAhPT0gdmFsdWUpIHtcbiAgICAgICAgICAgICAgICB0aGlzLnVuaWZvcm1zLnVTYW1wbGVyID0gdmFsdWU7XG4gICAgICAgICAgICAgICAgdGhpcy51dk1hdHJpeC50ZXh0dXJlID0gdmFsdWU7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IGZhbHNlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoTWVzaE1hdGVyaWFsLnByb3RvdHlwZSwgXCJhbHBoYVwiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuX2FscGhhO1xuICAgICAgICB9LFxuICAgICAgICAvKipcbiAgICAgICAgICogVGhpcyBnZXRzIGF1dG9tYXRpY2FsbHkgc2V0IGJ5IHRoZSBvYmplY3QgdXNpbmcgdGhpcy5cbiAgICAgICAgICpcbiAgICAgICAgICogQGRlZmF1bHQgMVxuICAgICAgICAgKiBAbWVtYmVyIHtudW1iZXJ9XG4gICAgICAgICAqL1xuICAgICAgICBzZXQ6IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICAgICAgaWYgKHZhbHVlID09PSB0aGlzLl9hbHBoYSlcbiAgICAgICAgICAgICAgICB7IHJldHVybjsgfVxuICAgICAgICAgICAgdGhpcy5fYWxwaGEgPSB2YWx1ZTtcbiAgICAgICAgICAgIHRoaXMuX2NvbG9yRGlydHkgPSB0cnVlO1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiBmYWxzZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KE1lc2hNYXRlcmlhbC5wcm90b3R5cGUsIFwidGludFwiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuX3RpbnQ7XG4gICAgICAgIH0sXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBNdWx0aXBseSB0aW50IGZvciB0aGUgbWF0ZXJpYWwuXG4gICAgICAgICAqIEBtZW1iZXIge251bWJlcn1cbiAgICAgICAgICogQGRlZmF1bHQgMHhGRkZGRkZcbiAgICAgICAgICovXG4gICAgICAgIHNldDogZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgICAgICBpZiAodmFsdWUgPT09IHRoaXMuX3RpbnQpXG4gICAgICAgICAgICAgICAgeyByZXR1cm47IH1cbiAgICAgICAgICAgIHRoaXMuX3RpbnQgPSB2YWx1ZTtcbiAgICAgICAgICAgIHRoaXMuX3RpbnRSR0IgPSAodmFsdWUgPj4gMTYpICsgKHZhbHVlICYgMHhmZjAwKSArICgodmFsdWUgJiAweGZmKSA8PCAxNik7XG4gICAgICAgICAgICB0aGlzLl9jb2xvckRpcnR5ID0gdHJ1ZTtcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogZmFsc2UsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIC8qKlxuICAgICAqIEdldHMgY2FsbGVkIGF1dG9tYXRpY2FsbHkgYnkgdGhlIE1lc2guIEludGVuZGVkIHRvIGJlIG92ZXJyaWRkZW4gZm9yIGN1c3RvbVxuICAgICAqIE1lc2hNYXRlcmlhbCBvYmplY3RzLlxuICAgICAqL1xuICAgIE1lc2hNYXRlcmlhbC5wcm90b3R5cGUudXBkYXRlID0gZnVuY3Rpb24gKCkge1xuICAgICAgICBpZiAodGhpcy5fY29sb3JEaXJ0eSkge1xuICAgICAgICAgICAgdGhpcy5fY29sb3JEaXJ0eSA9IGZhbHNlO1xuICAgICAgICAgICAgdmFyIGJhc2VUZXh0dXJlID0gdGhpcy50ZXh0dXJlLmJhc2VUZXh0dXJlO1xuICAgICAgICAgICAgcHJlbXVsdGlwbHlUaW50VG9SZ2JhKHRoaXMuX3RpbnQsIHRoaXMuX2FscGhhLCB0aGlzLnVuaWZvcm1zLnVDb2xvciwgYmFzZVRleHR1cmUuYWxwaGFNb2RlKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAodGhpcy51dk1hdHJpeC51cGRhdGUoKSkge1xuICAgICAgICAgICAgdGhpcy51bmlmb3Jtcy51VGV4dHVyZU1hdHJpeCA9IHRoaXMudXZNYXRyaXgubWFwQ29vcmQ7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIHJldHVybiBNZXNoTWF0ZXJpYWw7XG59KFNoYWRlcikpO1xuXG4vKipcbiAqIFN0YW5kYXJkIDJEIGdlb21ldHJ5IHVzZWQgaW4gUGl4aUpTLlxuICpcbiAqIEdlb21ldHJ5IGNhbiBiZSBkZWZpbmVkIHdpdGhvdXQgcGFzc2luZyBpbiBhIHN0eWxlIG9yIGRhdGEgaWYgcmVxdWlyZWQuXG4gKlxuICogYGBganNcbiAqIGNvbnN0IGdlb21ldHJ5ID0gbmV3IFBJWEkuR2VvbWV0cnkoKTtcbiAqXG4gKiBnZW9tZXRyeS5hZGRBdHRyaWJ1dGUoJ3Bvc2l0aW9ucycsIFswLCAwLCAxMDAsIDAsIDEwMCwgMTAwLCAwLCAxMDBdLCAyKTtcbiAqIGdlb21ldHJ5LmFkZEF0dHJpYnV0ZSgndXZzJywgWzAsMCwxLDAsMSwxLDAsMV0sIDIpO1xuICogZ2VvbWV0cnkuYWRkSW5kZXgoWzAsMSwyLDEsMywyXSk7XG4gKlxuICogYGBgXG4gKiBAY2xhc3NcbiAqIEBtZW1iZXJvZiBQSVhJXG4gKiBAZXh0ZW5kcyBQSVhJLkdlb21ldHJ5XG4gKi9cbnZhciBNZXNoR2VvbWV0cnkgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoX3N1cGVyKSB7XG4gICAgX19leHRlbmRzKE1lc2hHZW9tZXRyeSwgX3N1cGVyKTtcbiAgICAvKipcbiAgICAgKiBAcGFyYW0ge0Zsb2F0MzJBcnJheXxudW1iZXJbXX0gW3ZlcnRpY2VzXSAtIFBvc2l0aW9uYWwgZGF0YSBvbiBnZW9tZXRyeS5cbiAgICAgKiBAcGFyYW0ge0Zsb2F0MzJBcnJheXxudW1iZXJbXX0gW3V2c10gLSBUZXh0dXJlIFVWcy5cbiAgICAgKiBAcGFyYW0ge1VpbnQxNkFycmF5fG51bWJlcltdfSBbaW5kZXhdIC0gSW5kZXhCdWZmZXJcbiAgICAgKi9cbiAgICBmdW5jdGlvbiBNZXNoR2VvbWV0cnkodmVydGljZXMsIHV2cywgaW5kZXgpIHtcbiAgICAgICAgdmFyIF90aGlzID0gX3N1cGVyLmNhbGwodGhpcykgfHwgdGhpcztcbiAgICAgICAgdmFyIHZlcnRpY2VzQnVmZmVyID0gbmV3IEJ1ZmZlcih2ZXJ0aWNlcyk7XG4gICAgICAgIHZhciB1dnNCdWZmZXIgPSBuZXcgQnVmZmVyKHV2cywgdHJ1ZSk7XG4gICAgICAgIHZhciBpbmRleEJ1ZmZlciA9IG5ldyBCdWZmZXIoaW5kZXgsIHRydWUsIHRydWUpO1xuICAgICAgICBfdGhpcy5hZGRBdHRyaWJ1dGUoJ2FWZXJ0ZXhQb3NpdGlvbicsIHZlcnRpY2VzQnVmZmVyLCAyLCBmYWxzZSwgVFlQRVMuRkxPQVQpXG4gICAgICAgICAgICAuYWRkQXR0cmlidXRlKCdhVGV4dHVyZUNvb3JkJywgdXZzQnVmZmVyLCAyLCBmYWxzZSwgVFlQRVMuRkxPQVQpXG4gICAgICAgICAgICAuYWRkSW5kZXgoaW5kZXhCdWZmZXIpO1xuICAgICAgICAvKipcbiAgICAgICAgICogRGlydHkgZmxhZyB0byBsaW1pdCB1cGRhdGUgY2FsbHMgb24gTWVzaC4gRm9yIGV4YW1wbGUsXG4gICAgICAgICAqIGxpbWl0aW5nIHVwZGF0ZXMgb24gYSBzaW5nbGUgTWVzaCBpbnN0YW5jZSB3aXRoIGEgc2hhcmVkIEdlb21ldHJ5XG4gICAgICAgICAqIHdpdGhpbiB0aGUgcmVuZGVyIGxvb3AuXG4gICAgICAgICAqIEBwcml2YXRlXG4gICAgICAgICAqIEBtZW1iZXIge251bWJlcn1cbiAgICAgICAgICogQGRlZmF1bHQgLTFcbiAgICAgICAgICovXG4gICAgICAgIF90aGlzLl91cGRhdGVJZCA9IC0xO1xuICAgICAgICByZXR1cm4gX3RoaXM7XG4gICAgfVxuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShNZXNoR2VvbWV0cnkucHJvdG90eXBlLCBcInZlcnRleERpcnR5SWRcIiwge1xuICAgICAgICAvKipcbiAgICAgICAgICogSWYgdGhlIHZlcnRleCBwb3NpdGlvbiBpcyB1cGRhdGVkLlxuICAgICAgICAgKiBAbWVtYmVyIHtudW1iZXJ9XG4gICAgICAgICAqIEByZWFkb25seVxuICAgICAgICAgKiBAcHJpdmF0ZVxuICAgICAgICAgKi9cbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5idWZmZXJzWzBdLl91cGRhdGVJRDtcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogZmFsc2UsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIHJldHVybiBNZXNoR2VvbWV0cnk7XG59KEdlb21ldHJ5KSk7XG5cbmV4cG9ydCB7IE1lc2gsIE1lc2hCYXRjaFV2cywgTWVzaEdlb21ldHJ5LCBNZXNoTWF0ZXJpYWwgfTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPW1lc2guZXMuanMubWFwXG4iXSwic291cmNlUm9vdCI6IiJ9