(global.webpackChunkvht11=global.webpackChunkvht11||[]).push([["C:\\Users\\huynh\\IdeaProjects\\vht11\\node_modules\\@pixi\\ticker\\lib\\ticker.es"],{"./node_modules/@pixi/ticker/lib/ticker.es.js":(t,e,i)=>{"use strict";i.r(e),i.d(e,{Ticker:()=>o,TickerPlugin:()=>h,UPDATE_PRIORITY:()=>s});var s,n=i("./node_modules/@pixi/settings/lib/settings.es.js");n.settings.TARGET_FPMS=.06,function(t){t[t.INTERACTION=50]="INTERACTION",t[t.HIGH=25]="HIGH",t[t.NORMAL=0]="NORMAL",t[t.LOW=-25]="LOW",t[t.UTILITY=-50]="UTILITY"}(s||(s={}));var r=function(){function t(t,e,i,s){void 0===e&&(e=null),void 0===i&&(i=0),void 0===s&&(s=!1),this.fn=t,this.context=e,this.priority=i,this.once=s,this.next=null,this.previous=null,this._destroyed=!1}return t.prototype.match=function(t,e){return void 0===e&&(e=null),this.fn===t&&this.context===e},t.prototype.emit=function(t){this.fn&&(this.context?this.fn.call(this.context,t):this.fn(t));var e=this.next;return this.once&&this.destroy(!0),this._destroyed&&(this.next=null),e},t.prototype.connect=function(t){this.previous=t,t.next&&(t.next.previous=this),this.next=t.next,t.next=this},t.prototype.destroy=function(t){void 0===t&&(t=!1),this._destroyed=!0,this.fn=null,this.context=null,this.previous&&(this.previous.next=this.next),this.next&&(this.next.previous=this.previous);var e=this.next;return this.next=t?null:e,this.previous=null,e},t}(),o=function(){function t(){var t=this;this._head=new r(null,null,1/0),this._requestId=null,this._maxElapsedMS=100,this._minElapsedMS=0,this.autoStart=!1,this.deltaTime=1,this.deltaMS=1/n.settings.TARGET_FPMS,this.elapsedMS=1/n.settings.TARGET_FPMS,this.lastTime=-1,this.speed=1,this.started=!1,this._protected=!1,this._lastFrame=-1,this._tick=function(e){t._requestId=null,t.started&&(t.update(e),t.started&&null===t._requestId&&t._head.next&&(t._requestId=requestAnimationFrame(t._tick)))}}return t.prototype._requestIfNeeded=function(){null===this._requestId&&this._head.next&&(this.lastTime=performance.now(),this._lastFrame=this.lastTime,this._requestId=requestAnimationFrame(this._tick))},t.prototype._cancelIfNeeded=function(){null!==this._requestId&&(cancelAnimationFrame(this._requestId),this._requestId=null)},t.prototype._startIfPossible=function(){this.started?this._requestIfNeeded():this.autoStart&&this.start()},t.prototype.add=function(t,e,i){return void 0===i&&(i=s.NORMAL),this._addListener(new r(t,e,i))},t.prototype.addOnce=function(t,e,i){return void 0===i&&(i=s.NORMAL),this._addListener(new r(t,e,i,!0))},t.prototype._addListener=function(t){var e=this._head.next,i=this._head;if(e){for(;e;){if(t.priority>e.priority){t.connect(i);break}i=e,e=e.next}t.previous||t.connect(i)}else t.connect(i);return this._startIfPossible(),this},t.prototype.remove=function(t,e){for(var i=this._head.next;i;)i=i.match(t,e)?i.destroy():i.next;return this._head.next||this._cancelIfNeeded(),this},Object.defineProperty(t.prototype,"count",{get:function(){if(!this._head)return 0;for(var t=0,e=this._head;e=e.next;)t++;return t},enumerable:!1,configurable:!0}),t.prototype.start=function(){this.started||(this.started=!0,this._requestIfNeeded())},t.prototype.stop=function(){this.started&&(this.started=!1,this._cancelIfNeeded())},t.prototype.destroy=function(){if(!this._protected){this.stop();for(var t=this._head.next;t;)t=t.destroy(!0);this._head.destroy(),this._head=null}},t.prototype.update=function(t){var e;if(void 0===t&&(t=performance.now()),t>this.lastTime){if((e=this.elapsedMS=t-this.lastTime)>this._maxElapsedMS&&(e=this._maxElapsedMS),e*=this.speed,this._minElapsedMS){var i=t-this._lastFrame|0;if(i<this._minElapsedMS)return;this._lastFrame=t-i%this._minElapsedMS}this.deltaMS=e,this.deltaTime=this.deltaMS*n.settings.TARGET_FPMS;for(var s=this._head,r=s.next;r;)r=r.emit(this.deltaTime);s.next||this._cancelIfNeeded()}else this.deltaTime=this.deltaMS=this.elapsedMS=0;this.lastTime=t},Object.defineProperty(t.prototype,"FPS",{get:function(){return 1e3/this.elapsedMS},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"minFPS",{get:function(){return 1e3/this._maxElapsedMS},set:function(t){var e=Math.min(this.maxFPS,t),i=Math.min(Math.max(0,e)/1e3,n.settings.TARGET_FPMS);this._maxElapsedMS=1/i},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"maxFPS",{get:function(){return this._minElapsedMS?Math.round(1e3/this._minElapsedMS):0},set:function(t){if(0===t)this._minElapsedMS=0;else{var e=Math.max(this.minFPS,t);this._minElapsedMS=1/(e/1e3)}},enumerable:!1,configurable:!0}),Object.defineProperty(t,"shared",{get:function(){if(!t._shared){var e=t._shared=new t;e.autoStart=!0,e._protected=!0}return t._shared},enumerable:!1,configurable:!0}),Object.defineProperty(t,"system",{get:function(){if(!t._system){var e=t._system=new t;e.autoStart=!0,e._protected=!0}return t._system},enumerable:!1,configurable:!0}),t}(),h=function(){function t(){}return t.init=function(t){var e=this;t=Object.assign({autoStart:!0,sharedTicker:!1},t),Object.defineProperty(this,"ticker",{set:function(t){this._ticker&&this._ticker.remove(this.render,this),this._ticker=t,t&&t.add(this.render,this,s.LOW)},get:function(){return this._ticker}}),this.stop=function(){e._ticker.stop()},this.start=function(){e._ticker.start()},this._ticker=null,this.ticker=t.sharedTicker?o.shared:new o,t.autoStart&&this.start()},t.destroy=function(){if(this._ticker){var t=this._ticker;this.ticker=null,t.destroy()}},t}()}}]);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly92aHQxMS8uL25vZGVfbW9kdWxlcy9AcGl4aS90aWNrZXIvbGliL3RpY2tlci5lcy5qcyJdLCJuYW1lcyI6WyJVUERBVEVfUFJJT1JJVFkiLCJzZXR0aW5ncyIsIlRpY2tlckxpc3RlbmVyIiwiZm4iLCJjb250ZXh0IiwicHJpb3JpdHkiLCJvbmNlIiwidGhpcyIsIm5leHQiLCJwcmV2aW91cyIsIl9kZXN0cm95ZWQiLCJwcm90b3R5cGUiLCJtYXRjaCIsImVtaXQiLCJkZWx0YVRpbWUiLCJjYWxsIiwicmVkaXJlY3QiLCJkZXN0cm95IiwiY29ubmVjdCIsImhhcmQiLCJUaWNrZXIiLCJfdGhpcyIsIl9oZWFkIiwiSW5maW5pdHkiLCJfcmVxdWVzdElkIiwiX21heEVsYXBzZWRNUyIsIl9taW5FbGFwc2VkTVMiLCJhdXRvU3RhcnQiLCJkZWx0YU1TIiwiZWxhcHNlZE1TIiwibGFzdFRpbWUiLCJzcGVlZCIsInN0YXJ0ZWQiLCJfcHJvdGVjdGVkIiwiX2xhc3RGcmFtZSIsIl90aWNrIiwidGltZSIsInVwZGF0ZSIsInJlcXVlc3RBbmltYXRpb25GcmFtZSIsIl9yZXF1ZXN0SWZOZWVkZWQiLCJwZXJmb3JtYW5jZSIsIm5vdyIsIl9jYW5jZWxJZk5lZWRlZCIsImNhbmNlbEFuaW1hdGlvbkZyYW1lIiwiX3N0YXJ0SWZQb3NzaWJsZSIsInN0YXJ0IiwiYWRkIiwiTk9STUFMIiwiX2FkZExpc3RlbmVyIiwiYWRkT25jZSIsImxpc3RlbmVyIiwiY3VycmVudCIsInJlbW92ZSIsIk9iamVjdCIsImRlZmluZVByb3BlcnR5IiwiZ2V0IiwiY291bnQiLCJlbnVtZXJhYmxlIiwiY29uZmlndXJhYmxlIiwic3RvcCIsImN1cnJlbnRUaW1lIiwiZGVsdGEiLCJoZWFkIiwic2V0IiwiZnBzIiwibWluRlBTIiwiTWF0aCIsIm1pbiIsIm1heEZQUyIsIm1pbkZQTVMiLCJtYXgiLCJyb3VuZCIsIl9zaGFyZWQiLCJzaGFyZWQiLCJfc3lzdGVtIiwic3lzdGVtIiwiVGlja2VyUGx1Z2luIiwiaW5pdCIsIm9wdGlvbnMiLCJhc3NpZ24iLCJzaGFyZWRUaWNrZXIiLCJ0aWNrZXIiLCJfdGlja2VyIiwicmVuZGVyIiwiTE9XIiwib2xkVGlja2VyIl0sIm1hcHBpbmdzIjoic1NBb0NJQSxFLHdEQWxCSixFQUFBQyxTQUFBLFlBQXVCLElBbUJ2QixTQUFXRCxHQUNQQSxFQUFnQkEsRUFBNkIsWUFBSSxJQUFNLGNBQ3ZEQSxFQUFnQkEsRUFBc0IsS0FBSSxJQUFNLE9BQ2hEQSxFQUFnQkEsRUFBd0IsT0FBSSxHQUFLLFNBQ2pEQSxFQUFnQkEsRUFBcUIsS0FBSyxJQUFNLE1BQ2hEQSxFQUFnQkEsRUFBeUIsU0FBSyxJQUFNLFVBTHhELENBTUdBLElBQW9CQSxFQUFrQixLQVN6QyxJQUFJRSxFQUFnQyxXQVNoQyxTQUFTQSxFQUFlQyxFQUFJQyxFQUFTQyxFQUFVQyxRQUMzQixJQUFaRixJQUFzQkEsRUFBVSxXQUNuQixJQUFiQyxJQUF1QkEsRUFBVyxRQUN6QixJQUFUQyxJQUFtQkEsR0FBTyxHQU05QkMsS0FBS0osR0FBS0EsRUFNVkksS0FBS0gsUUFBVUEsRUFNZkcsS0FBS0YsU0FBV0EsRUFNaEJFLEtBQUtELEtBQU9BLEVBTVpDLEtBQUtDLEtBQU8sS0FNWkQsS0FBS0UsU0FBVyxLQU1oQkYsS0FBS0csWUFBYSxFQThFdEIsT0FyRUFSLEVBQWVTLFVBQVVDLE1BQVEsU0FBVVQsRUFBSUMsR0FFM0MsWUFEZ0IsSUFBWkEsSUFBc0JBLEVBQVUsTUFDN0JHLEtBQUtKLEtBQU9BLEdBQU1JLEtBQUtILFVBQVlBLEdBUTlDRixFQUFlUyxVQUFVRSxLQUFPLFNBQVVDLEdBQ2xDUCxLQUFLSixLQUNESSxLQUFLSCxRQUNMRyxLQUFLSixHQUFHWSxLQUFLUixLQUFLSCxRQUFTVSxHQUczQlAsS0FBS0osR0FBR1csSUFHaEIsSUFBSUUsRUFBV1QsS0FBS0MsS0FTcEIsT0FSSUQsS0FBS0QsTUFDTEMsS0FBS1UsU0FBUSxHQUliVixLQUFLRyxhQUNMSCxLQUFLQyxLQUFPLE1B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QU9sQnBELEtBQUtzQyxNQUFRLFdBQ1R4QixFQUFNNkQsUUFBUXJDLFNBVWxCdEMsS0FBSzJFLFFBQVUsS0FTZjNFLEtBQUswRSxPQUFTSCxFQUFRRSxhQUFlNUQsRUFBT3FELE9BQVMsSUFBSXJELEVBRXJEMEQsRUFBUW5ELFdBQ1JwQixLQUFLc0MsU0FTYitCLEVBQWEzRCxRQUFVLFdBQ25CLEdBQUlWLEtBQUsyRSxRQUFTLENBQ2QsSUFBSUcsRUFBWTlFLEtBQUsyRSxRQUNyQjNFLEtBQUswRSxPQUFTLEtBQ2RJLEVBQVVwRSxZQUdYMkQsRUFwRnNCIiwiZmlsZSI6IjA3ZDljMGZlMTMxYTE2ZjEwNjk2LmpzIiwic291cmNlc0NvbnRlbnQiOlsiLyohXG4gKiBAcGl4aS90aWNrZXIgLSB2NS4zLjdcbiAqIENvbXBpbGVkIFR1ZSwgMjkgRGVjIDIwMjAgMTk6MzA6MTEgVVRDXG4gKlxuICogQHBpeGkvdGlja2VyIGlzIGxpY2Vuc2VkIHVuZGVyIHRoZSBNSVQgTGljZW5zZS5cbiAqIGh0dHA6Ly93d3cub3BlbnNvdXJjZS5vcmcvbGljZW5zZXMvbWl0LWxpY2Vuc2VcbiAqL1xuaW1wb3J0IHsgc2V0dGluZ3MgfSBmcm9tICdAcGl4aS9zZXR0aW5ncyc7XG5cbi8qKlxuICogVGFyZ2V0IGZyYW1lcyBwZXIgbWlsbGlzZWNvbmQuXG4gKlxuICogQHN0YXRpY1xuICogQG5hbWUgVEFSR0VUX0ZQTVNcbiAqIEBtZW1iZXJvZiBQSVhJLnNldHRpbmdzXG4gKiBAdHlwZSB7bnVtYmVyfVxuICogQGRlZmF1bHQgMC4wNlxuICovXG5zZXR0aW5ncy5UQVJHRVRfRlBNUyA9IDAuMDY7XG5cbi8qKlxuICogUmVwcmVzZW50cyB0aGUgdXBkYXRlIHByaW9yaXRpZXMgdXNlZCBieSBpbnRlcm5hbCBQSVhJIGNsYXNzZXMgd2hlbiByZWdpc3RlcmVkIHdpdGhcbiAqIHRoZSB7QGxpbmsgUElYSS5UaWNrZXJ9IG9iamVjdC4gSGlnaGVyIHByaW9yaXR5IGl0ZW1zIGFyZSB1cGRhdGVkIGZpcnN0IGFuZCBsb3dlclxuICogcHJpb3JpdHkgaXRlbXMsIHN1Y2ggYXMgcmVuZGVyLCBzaG91bGQgZ28gbGF0ZXIuXG4gKlxuICogQHN0YXRpY1xuICogQGNvbnN0YW50XG4gKiBAbmFtZSBVUERBVEVfUFJJT1JJVFlcbiAqIEBtZW1iZXJvZiBQSVhJXG4gKiBAZW51bSB7bnVtYmVyfVxuICogQHByb3BlcnR5IHtudW1iZXJ9IElOVEVSQUNUSU9OPTUwIEhpZ2hlc3QgcHJpb3JpdHksIHVzZWQgZm9yIHtAbGluayBQSVhJLkludGVyYWN0aW9uTWFuYWdlcn1cbiAqIEBwcm9wZXJ0eSB7bnVtYmVyfSBISUdIPTI1IEhpZ2ggcHJpb3JpdHkgdXBkYXRpbmcsIHtAbGluayBQSVhJLlZpZGVvQmFzZVRleHR1cmV9IGFuZCB7QGxpbmsgUElYSS5BbmltYXRlZFNwcml0ZX1cbiAqIEBwcm9wZXJ0eSB7bnVtYmVyfSBOT1JNQUw9MCBEZWZhdWx0IHByaW9yaXR5IGZvciB0aWNrZXIgZXZlbnRzLCBzZWUge0BsaW5rIFBJWEkuVGlja2VyI2FkZH0uXG4gKiBAcHJvcGVydHkge251bWJlcn0gTE9XPS0yNSBMb3cgcHJpb3JpdHkgdXNlZCBmb3Ige0BsaW5rIFBJWEkuQXBwbGljYXRpb259IHJlbmRlcmluZy5cbiAqIEBwcm9wZXJ0eSB7bnVtYmVyfSBVVElMSVRZPS01MCBMb3dlc3QgcHJpb3JpdHkgdXNlZCBmb3Ige0BsaW5rIFBJWEkuQmFzZVByZXBhcmV9IHV0aWxpdHkuXG4gKi9cbnZhciBVUERBVEVfUFJJT1JJVFk7XG4oZnVuY3Rpb24gKFVQREFURV9QUklPUklUWSkge1xuICAgIFVQREFURV9QUklPUklUWVtVUERBVEVfUFJJT1JJVFlbXCJJTlRFUkFDVElPTlwiXSA9IDUwXSA9IFwiSU5URVJBQ1RJT05cIjtcbiAgICBVUERBVEVfUFJJT1JJVFlbVVBEQVRFX1BSSU9SSVRZW1wiSElHSFwiXSA9IDI1XSA9IFwiSElHSFwiO1xuICAgIFVQREFURV9QUklPUklUWVtVUERBVEVfUFJJT1JJVFlbXCJOT1JNQUxcIl0gPSAwXSA9IFwiTk9STUFMXCI7XG4gICAgVVBEQVRFX1BSSU9SSVRZW1VQREFURV9QUklPUklUWVtcIkxPV1wiXSA9IC0yNV0gPSBcIkxPV1wiO1xuICAgIFVQREFURV9QUklPUklUWVtVUERBVEVfUFJJT1JJVFlbXCJVVElMSVRZXCJdID0gLTUwXSA9IFwiVVRJTElUWVwiO1xufSkoVVBEQVRFX1BSSU9SSVRZIHx8IChVUERBVEVfUFJJT1JJVFkgPSB7fSkpO1xuXG4vKipcbiAqIEludGVybmFsIGNsYXNzIGZvciBoYW5kbGluZyB0aGUgcHJpb3JpdHkgc29ydGluZyBvZiB0aWNrZXIgaGFuZGxlcnMuXG4gKlxuICogQHByaXZhdGVcbiAqIEBjbGFzc1xuICogQG1lbWJlcm9mIFBJWElcbiAqL1xudmFyIFRpY2tlckxpc3RlbmVyID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkge1xuICAgIC8qKlxuICAgICAqIENvbnN0cnVjdG9yXG4gICAgICogQHByaXZhdGVcbiAgICAgKiBAcGFyYW0ge0Z1bmN0aW9ufSBmbiAtIFRoZSBsaXN0ZW5lciBmdW5jdGlvbiB0byBiZSBhZGRlZCBmb3Igb25lIHVwZGF0ZVxuICAgICAqIEBwYXJhbSB7Kn0gW2NvbnRleHQ9bnVsbF0gLSBUaGUgbGlzdGVuZXIgY29udGV4dFxuICAgICAqIEBwYXJhbSB7bnVtYmVyfSBbcHJpb3JpdHk9MF0gLSBUaGUgcHJpb3JpdHkgZm9yIGVtaXR0aW5nXG4gICAgICogQHBhcmFtIHtib29sZWFufSBbb25jZT1mYWxzZV0gLSBJZiB0aGUgaGFuZGxlciBzaG91bGQgZmlyZSBvbmNlXG4gICAgICovXG4gICAgZnVuY3Rpb24gVGlja2VyTGlzdGVuZXIoZm4sIGNvbnRleHQsIHByaW9yaXR5LCBvbmNlKSB7XG4gICAgICAgIGlmIChjb250ZXh0ID09PSB2b2lkIDApIHsgY29udGV4dCA9IG51bGw7IH1cbiAgICAgICAgaWYgKHByaW9yaXR5ID09PSB2b2lkIDApIHsgcHJpb3JpdHkgPSAwOyB9XG4gICAgICAgIGlmIChvbmNlID09PSB2b2lkIDApIHsgb25jZSA9IGZhbHNlOyB9XG4gICAgICAgIC8qKlxuICAgICAgICAgKiBUaGUgaGFuZGxlciBmdW5jdGlvbiB0byBleGVjdXRlLlxuICAgICAgICAgKiBAcHJpdmF0ZVxuICAgICAgICAgKiBAbWVtYmVyIHtGdW5jdGlvbn1cbiAgICAgICAgICovXG4gICAgICAgIHRoaXMuZm4gPSBmbjtcbiAgICAgICAgLyoqXG4gICAgICAgICAqIFRoZSBjYWxsaW5nIHRvIGV4ZWN1dGUuXG4gICAgICAgICAqIEBwcml2YXRlXG4gICAgICAgICAqIEBtZW1iZXIgeyp9XG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLmNvbnRleHQgPSBjb250ZXh0O1xuICAgICAgICAvKipcbiAgICAgICAgICogVGhlIGN1cnJlbnQgcHJpb3JpdHkuXG4gICAgICAgICAqIEBwcml2YXRlXG4gICAgICAgICAqIEBtZW1iZXIge251bWJlcn1cbiAgICAgICAgICovXG4gICAgICAgIHRoaXMucHJpb3JpdHkgPSBwcmlvcml0eTtcbiAgICAgICAgLyoqXG4gICAgICAgICAqIElmIHRoaXMgc2hvdWxkIG9ubHkgZXhlY3V0ZSBvbmNlLlxuICAgICAgICAgKiBAcHJpdmF0ZVxuICAgICAgICAgKiBAbWVtYmVyIHtib29sZWFufVxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy5vbmNlID0gb25jZTtcbiAgICAgICAgLyoqXG4gICAgICAgICAqIFRoZSBuZXh0IGl0ZW0gaW4gY2hhaW4uXG4gICAgICAgICAqIEBwcml2YXRlXG4gICAgICAgICAqIEBtZW1iZXIge1RpY2tlckxpc3RlbmVyfVxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy5uZXh0ID0gbnVsbDtcbiAgICAgICAgLyoqXG4gICAgICAgICAqIFRoZSBwcmV2aW91cyBpdGVtIGluIGNoYWluLlxuICAgICAgICAgKiBAcHJpdmF0ZVxuICAgICAgICAgKiBAbWVtYmVyIHtUaWNrZXJMaXN0ZW5lcn1cbiAgICAgICAgICovXG4gICAgICAgIHRoaXMucHJldmlvdXMgPSBudWxsO1xuICAgICAgICAvKipcbiAgICAgICAgICogYHRydWVgIGlmIHRoaXMgbGlzdGVuZXIgaGFzIGJlZW4gZGVzdHJveWVkIGFscmVhZHkuXG4gICAgICAgICAqIEBtZW1iZXIge2Jvb2xlYW59XG4gICAgICAgICAqIEBwcml2YXRlXG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLl9kZXN0cm95ZWQgPSBmYWxzZTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogU2ltcGxlIGNvbXBhcmUgZnVuY3Rpb24gdG8gZmlndXJlIG91dCBpZiBhIGZ1bmN0aW9uIGFuZCBjb250ZXh0IG1hdGNoLlxuICAgICAqIEBwcml2YXRlXG4gICAgICogQHBhcmFtIHtGdW5jdGlvbn0gZm4gLSBUaGUgbGlzdGVuZXIgZnVuY3Rpb24gdG8gYmUgYWRkZWQgZm9yIG9uZSB1cGRhdGVcbiAgICAgKiBAcGFyYW0ge2FueX0gW2NvbnRleHRdIC0gVGhlIGxpc3RlbmVyIGNvbnRleHRcbiAgICAgKiBAcmV0dXJuIHtib29sZWFufSBgdHJ1ZWAgaWYgdGhlIGxpc3RlbmVyIG1hdGNoIHRoZSBhcmd1bWVudHNcbiAgICAgKi9cbiAgICBUaWNrZXJMaXN0ZW5lci5wcm90b3R5cGUubWF0Y2ggPSBmdW5jdGlvbiAoZm4sIGNvbnRleHQpIHtcbiAgICAgICAgaWYgKGNvbnRleHQgPT09IHZvaWQgMCkgeyBjb250ZXh0ID0gbnVsbDsgfVxuICAgICAgICByZXR1cm4gdGhpcy5mbiA9PT0gZm4gJiYgdGhpcy5jb250ZXh0ID09PSBjb250ZXh0O1xuICAgIH07XG4gICAgLyoqXG4gICAgICogRW1pdCBieSBjYWxsaW5nIHRoZSBjdXJyZW50IGZ1bmN0aW9uLlxuICAgICAqIEBwcml2YXRlXG4gICAgICogQHBhcmFtIHtudW1iZXJ9IGRlbHRhVGltZSAtIHRpbWUgc2luY2UgdGhlIGxhc3QgZW1pdC5cbiAgICAgKiBAcmV0dXJuIHtUaWNrZXJMaXN0ZW5lcn0gTmV4dCB0aWNrZXJcbiAgICAgKi9cbiAgICBUaWNrZXJMaXN0ZW5lci5wcm90b3R5cGUuZW1pdCA9IGZ1bmN0aW9uIChkZWx0YVRpbWUpIHtcbiAgICAgICAgaWYgKHRoaXMuZm4pIHtcbiAgICAgICAgICAgIGlmICh0aGlzLmNvbnRleHQpIHtcbiAgICAgICAgICAgICAgICB0aGlzLmZuLmNhbGwodGhpcy5jb250ZXh0LCBkZWx0YVRpbWUpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgdGhpcy5mbihkZWx0YVRpbWUpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHZhciByZWRpcmVjdCA9IHRoaXMubmV4dDtcbiAgICAgICAgaWYgKHRoaXMub25jZSkge1xuICAgICAgICAgICAgdGhpcy5kZXN0cm95KHRydWUpO1xuICAgICAgICB9XG4gICAgICAgIC8vIFNvZnQtZGVzdHJveWluZyBzaG91bGQgcmVtb3ZlXG4gICAgICAgIC8vIHRoZSBuZXh0IHJlZmVyZW5jZVxuICAgICAgICBpZiAodGhpcy5fZGVzdHJveWVkKSB7XG4gICAgICAgICAgICB0aGlzLm5leHQgPSBudWxsO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiByZWRpcmVjdDtcbiAgICB9O1xuICAgIC8qKlxuICAgICAqIENvbm5lY3QgdG8gdGhlIGxpc3QuXG4gICAgICogQHByaXZhdGVcbiAgICAgKiBAcGFyYW0ge1RpY2tlckxpc3RlbmVyfSBwcmV2aW91cyAtIElucHV0IG5vZGUsIHByZXZpb3VzIGxpc3RlbmVyXG4gICAgICovXG4gICAgVGlja2VyTGlzdGVuZXIucHJvdG90eXBlLmNvbm5lY3QgPSBmdW5jdGlvbiAocHJldmlvdXMpIHtcbiAgICAgICAgdGhpcy5wcmV2aW91cyA9IHByZXZpb3VzO1xuICAgICAgICBpZiAocHJldmlvdXMubmV4dCkge1xuICAgICAgICAgICAgcHJldmlvdXMubmV4dC5wcmV2aW91cyA9IHRoaXM7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5uZXh0ID0gcHJldmlvdXMubmV4dDtcbiAgICAgICAgcHJldmlvdXMubmV4dCA9IHRoaXM7XG4gICAgfTtcbiAgICAvKipcbiAgICAgKiBEZXN0cm95IGFuZCBkb24ndCB1c2UgYWZ0ZXIgdGhpcy5cbiAgICAgKiBAcHJpdmF0ZVxuICAgICAqIEBwYXJhbSB7Ym9vbGVhbn0gW2hhcmQgPSBmYWxzZV0gYHRydWVgIHRvIHJlbW92ZSB0aGUgYG5leHRgIHJlZmVyZW5jZSwgdGhpc1xuICAgICAqICAgICAgICBpcyBjb25zaWRlcmVkIGEgaGFyZCBkZXN0cm95LiBTb2Z0IGRlc3Ryb3kgbWFpbnRhaW5zIHRoZSBuZXh0IHJlZmVyZW5jZS5cbiAgICAgKiBAcmV0dXJuIHtUaWNrZXJMaXN0ZW5lcn0gVGhlIGxpc3RlbmVyIHRvIHJlZGlyZWN0IHdoaWxlIGVtaXR0aW5nIG9yIHJlbW92aW5nLlxuICAgICAqL1xuICAgIFRpY2tlckxpc3RlbmVyLnByb3RvdHlwZS5kZXN0cm95ID0gZnVuY3Rpb24gKGhhcmQpIHtcbiAgICAgICAgaWYgKGhhcmQgPT09IHZvaWQgMCkgeyBoYXJkID0gZmFsc2U7IH1cbiAgICAgICAgdGhpcy5fZGVzdHJveWVkID0gdHJ1ZTtcbiAgICAgICAgdGhpcy5mbiA9IG51bGw7XG4gICAgICAgIHRoaXMuY29udGV4dCA9IG51bGw7XG4gICAgICAgIC8vIERpc2Nvbm5lY3QsIGhvb2sgdXAgbmV4dCBhbmQgcHJldmlvdXNcbiAgICAgICAgaWYgKHRoaXMucHJldmlvdXMpIHtcbiAgICAgICAgICAgIHRoaXMucHJldmlvdXMubmV4dCA9IHRoaXMubmV4dDtcbiAgICAgICAgfVxuICAgICAgICBpZiAodGhpcy5uZXh0KSB7XG4gICAgICAgICAgICB0aGlzLm5leHQucHJldmlvdXMgPSB0aGlzLnByZXZpb3VzO1xuICAgICAgICB9XG4gICAgICAgIC8vIFJlZGlyZWN0IHRvIHRoZSBuZXh0IGl0ZW1cbiAgICAgICAgdmFyIHJlZGlyZWN0ID0gdGhpcy5uZXh0O1xuICAgICAgICAvLyBSZW1vdmUgcmVmZXJlbmNlc1xuICAgICAgICB0aGlzLm5leHQgPSBoYXJkID8gbnVsbCA6IHJlZGlyZWN0O1xuICAgICAgICB0aGlzLnByZXZpb3VzID0gbnVsbDtcbiAgICAgICAgcmV0dXJuIHJlZGlyZWN0O1xuICAgIH07XG4gICAgcmV0dXJuIFRpY2tlckxpc3RlbmVyO1xufSgpKTtcblxuLyoqXG4gKiBBIFRpY2tlciBjbGFzcyB0aGF0IHJ1bnMgYW4gdXBkYXRlIGxvb3AgdGhhdCBvdGhlciBvYmplY3RzIGxpc3RlbiB0by5cbiAqXG4gKiBUaGlzIGNsYXNzIGlzIGNvbXBvc2VkIGFyb3VuZCBsaXN0ZW5lcnMgbWVhbnQgZm9yIGV4ZWN1dGlvbiBvbiB0aGUgbmV4dCByZXF1ZXN0ZWQgYW5pbWF0aW9uIGZyYW1lLlxuICogQW5pbWF0aW9uIGZyYW1lcyBhcmUgcmVxdWVzdGVkIG9ubHkgd2hlbiBuZWNlc3NhcnksIGUuZy4gV2hlbiB0aGUgdGlja2VyIGlzIHN0YXJ0ZWQgYW5kIHRoZSBlbWl0dGVyIGhhcyBsaXN0ZW5lcnMuXG4gKlxuICogQGNsYXNzXG4gKiBAbWVtYmVyb2YgUElYSVxuICovXG52YXIgVGlja2VyID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkge1xuICAgIGZ1bmN0aW9uIFRpY2tlcigpIHtcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcbiAgICAgICAgLyoqXG4gICAgICAgICAqIFRoZSBmaXJzdCBsaXN0ZW5lci4gQWxsIG5ldyBsaXN0ZW5lcnMgYWRkZWQgYXJlIGNoYWluZWQgb24gdGhpcy5cbiAgICAgICAgICogQHByaXZhdGVcbiAgICAgICAgICogQHR5cGUge1RpY2tlckxpc3RlbmVyfVxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy5faGVhZCA9IG5ldyBUaWNrZXJMaXN0ZW5lcihudWxsLCBudWxsLCBJbmZpbml0eSk7XG4gICAgICAgIC8qKlxuICAgICAgICAgKiBJbnRlcm5hbCBjdXJyZW50IGZyYW1lIHJlcXVlc3QgSURcbiAgICAgICAgICogQHR5cGUgez9udW1iZXJ9XG4gICAgICAgICAqIEBwcml2YXRlXG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLl9yZXF1ZXN0SWQgPSBudWxsO1xuICAgICAgICAvKipcbiAgICAgICAgICogSW50ZXJuYWwgdmFsdWUgbWFuYWdlZCBieSBtaW5GUFMgcHJvcGVydHkgc2V0dGVyIGFuZCBnZXR0ZXIuXG4gICAgICAgICAqIFRoaXMgaXMgdGhlIG1heGltdW0gYWxsb3dlZCBtaWxsaXNlY29uZHMgYmV0d2VlbiB1cGRhdGVzLlxuICAgICAgICAgKiBAdHlwZSB7bnVtYmVyfVxuICAgICAgICAgKiBAcHJpdmF0ZVxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy5fbWF4RWxhcHNlZE1TID0gMTAwO1xuICAgICAgICAvKipcbiAgICAgICAgICogSW50ZXJuYWwgdmFsdWUgbWFuYWdlZCBieSBtYXhGUFMgcHJvcGVydHkgc2V0dGVyIGFuZCBnZXR0ZXIuXG4gICAgICAgICAqIFRoaXMgaXMgdGhlIG1pbmltdW0gYWxsb3dlZCBtaWxsaXNlY29uZHMgYmV0d2VlbiB1cGRhdGVzLlxuICAgICAgICAgKiBAdHlwZSB7bnVtYmVyfVxuICAgICAgICAgKiBAcHJpdmF0ZVxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy5fbWluRWxhcHNlZE1TID0gMDtcbiAgICAgICAgLyoqXG4gICAgICAgICAqIFdoZXRoZXIgb3Igbm90IHRoaXMgdGlja2VyIHNob3VsZCBpbnZva2UgdGhlIG1ldGhvZFxuICAgICAgICAgKiB7QGxpbmsgUElYSS5UaWNrZXIjc3RhcnR9IGF1dG9tYXRpY2FsbHlcbiAgICAgICAgICogd2hlbiBhIGxpc3RlbmVyIGlzIGFkZGVkLlxuICAgICAgICAgKlxuICAgICAgICAgKiBAbWVtYmVyIHtib29sZWFufVxuICAgICAgICAgKiBAZGVmYXVsdCBmYWxzZVxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy5hdXRvU3RhcnQgPSBmYWxzZTtcbiAgICAgICAgLyoqXG4gICAgICAgICAqIFNjYWxhciB0aW1lIHZhbHVlIGZyb20gbGFzdCBmcmFtZSB0byB0aGlzIGZyYW1lLlxuICAgICAgICAgKiBUaGlzIHZhbHVlIGlzIGNhcHBlZCBieSBzZXR0aW5nIHtAbGluayBQSVhJLlRpY2tlciNtaW5GUFN9XG4gICAgICAgICAqIGFuZCBpcyBzY2FsZWQgd2l0aCB7QGxpbmsgUElYSS5UaWNrZXIjc3BlZWR9LlxuICAgICAgICAgKiAqKk5vdGU6KiogVGhlIGNhcCBtYXkgYmUgZXhjZWVkZWQgYnkgc2NhbGluZy5cbiAgICAgICAgICpcbiAgICAgICAgICogQG1lbWJlciB7bnVtYmVyfVxuICAgICAgICAgKiBAZGVmYXVsdCAxXG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLmRlbHRhVGltZSA9IDE7XG4gICAgICAgIC8qKlxuICAgICAgICAgKiBTY2FsZXIgdGltZSBlbGFwc2VkIGluIG1pbGxpc2Vjb25kcyBmcm9tIGxhc3QgZnJhbWUgdG8gdGhpcyBmcmFtZS5cbiAgICAgICAgICogVGhpcyB2YWx1ZSBpcyBjYXBwZWQgYnkgc2V0dGluZyB7QGxpbmsgUElYSS5UaWNrZXIjbWluRlBTfVxuICAgICAgICAgKiBhbmQgaXMgc2NhbGVkIHdpdGgge0BsaW5rIFBJWEkuVGlja2VyI3NwZWVkfS5cbiAgICAgICAgICogKipOb3RlOioqIFRoZSBjYXAgbWF5IGJlIGV4Y2VlZGVkIGJ5IHNjYWxpbmcuXG4gICAgICAgICAqIElmIHRoZSBwbGF0Zm9ybSBzdXBwb3J0cyBET01IaWdoUmVzVGltZVN0YW1wLFxuICAgICAgICAgKiB0aGlzIHZhbHVlIHdpbGwgaGF2ZSBhIHByZWNpc2lvbiBvZiAxIMK1cy5cbiAgICAgICAgICogRGVmYXVsdHMgdG8gdGFyZ2V0IGZyYW1lIHRpbWVcbiAgICAgICAgICpcbiAgICAgICAgICogQG1lbWJlciB7bnVtYmVyfVxuICAgICAgICAgKiBAZGVmYXVsdCAxNi42NlxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy5kZWx0YU1TID0gMSAvIHNldHRpbmdzLlRBUkdFVF9GUE1TO1xuICAgICAgICAvKipcbiAgICAgICAgICogVGltZSBlbGFwc2VkIGluIG1pbGxpc2Vjb25kcyBmcm9tIGxhc3QgZnJhbWUgdG8gdGhpcyBmcmFtZS5cbiAgICAgICAgICogT3Bwb3NlZCB0byB3aGF0IHRoZSBzY2FsYXIge0BsaW5rIFBJWEkuVGlja2VyI2RlbHRhVGltZX1cbiAgICAgICAgICogaXMgYmFzZWQsIHRoaXMgdmFsdWUgaXMgbmVpdGhlciBjYXBwZWQgbm9yIHNjYWxlZC5cbiAgICAgICAgICogSWYgdGhlIHBsYXRmb3JtIHN1cHBvcnRzIERPTUhpZ2hSZXNUaW1lU3RhbXAsXG4gICAgICAgICAqIHRoaXMgdmFsdWUgd2lsbCBoYXZlIGEgcHJlY2lzaW9uIG9mIDEgwrVzLlxuICAgICAgICAgKiBEZWZhdWx0cyB0byB0YXJnZXQgZnJhbWUgdGltZVxuICAgICAgICAgKlxuICAgICAgICAgKiBAbWVtYmVyIHtudW1iZXJ9XG4gICAgICAgICAqIEBkZWZhdWx0IDE2LjY2XG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLmVsYXBzZWRNUyA9IDEgLyBzZXR0aW5ncy5UQVJHRVRfRlBNUztcbiAgICAgICAgLyoqXG4gICAgICAgICAqIFRoZSBsYXN0IHRpbWUge0BsaW5rIFBJWEkuVGlja2VyI3VwZGF0ZX0gd2FzIGludm9rZWQuXG4gICAgICAgICAqIFRoaXMgdmFsdWUgaXMgYWxzbyByZXNldCBpbnRlcm5hbGx5IG91dHNpZGUgb2YgaW52b2tpbmdcbiAgICAgICAgICogdXBkYXRlLCBidXQgb25seSB3aGVuIGEgbmV3IGFuaW1hdGlvbiBmcmFtZSBpcyByZXF1ZXN0ZWQuXG4gICAgICAgICAqIElmIHRoZSBwbGF0Zm9ybSBzdXBwb3J0cyBET01IaWdoUmVzVGltZVN0YW1wLFxuICAgICAgICAgKiB0aGlzIHZhbHVlIHdpbGwgaGF2ZSBhIHByZWNpc2lvbiBvZiAxIMK1cy5cbiAgICAgICAgICpcbiAgICAgICAgICogQG1lbWJlciB7bnVtYmVyfVxuICAgICAgICAgKiBAZGVmYXVsdCAtMVxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy5sYXN0VGltZSA9IC0xO1xuICAgICAgICAvKipcbiAgICAgICAgICogRmFjdG9yIG9mIGN1cnJlbnQge0BsaW5rIFBJWEkuVGlja2VyI2RlbHRhVGltZX0uXG4gICAgICAgICAqIEBleGFtcGxlXG4gICAgICAgICAqIC8vIFNjYWxlcyB0aWNrZXIuZGVsdGFUaW1lIHRvIHdoYXQgd291bGQgYmVcbiAgICAgICAgICogLy8gdGhlIGVxdWl2YWxlbnQgb2YgYXBwcm94aW1hdGVseSAxMjAgRlBTXG4gICAgICAgICAqIHRpY2tlci5zcGVlZCA9IDI7XG4gICAgICAgICAqXG4gICAgICAgICAqIEBtZW1iZXIge251bWJlcn1cbiAgICAgICAgICogQGRlZmF1bHQgMVxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy5zcGVlZCA9IDE7XG4gICAgICAgIC8qKlxuICAgICAgICAgKiBXaGV0aGVyIG9yIG5vdCB0aGlzIHRpY2tlciBoYXMgYmVlbiBzdGFydGVkLlxuICAgICAgICAgKiBgdHJ1ZWAgaWYge0BsaW5rIFBJWEkuVGlja2VyI3N0YXJ0fSBoYXMgYmVlbiBjYWxsZWQuXG4gICAgICAgICAqIGBmYWxzZWAgaWYge0BsaW5rIFBJWEkuVGlja2VyI3N0b3B9IGhhcyBiZWVuIGNhbGxlZC5cbiAgICAgICAgICogV2hpbGUgYGZhbHNlYCwgdGhpcyB2YWx1ZSBtYXkgY2hhbmdlIHRvIGB0cnVlYCBpbiB0aGVcbiAgICAgICAgICogZXZlbnQgb2Yge0BsaW5rIFBJWEkuVGlja2VyI2F1dG9TdGFydH0gYmVpbmcgYHRydWVgXG4gICAgICAgICAqIGFuZCBhIGxpc3RlbmVyIGlzIGFkZGVkLlxuICAgICAgICAgKlxuICAgICAgICAgKiBAbWVtYmVyIHtib29sZWFufVxuICAgICAgICAgKiBAZGVmYXVsdCBmYWxzZVxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy5zdGFydGVkID0gZmFsc2U7XG4gICAgICAgIC8qKlxuICAgICAgICAgKiBJZiBlbmFibGVkLCBkZWxldGluZyBpcyBkaXNhYmxlZC5cbiAgICAgICAgICogQG1lbWJlciB7Ym9vbGVhbn1cbiAgICAgICAgICogQGRlZmF1bHQgZmFsc2VcbiAgICAgICAgICogQHByaXZhdGVcbiAgICAgICAgICovXG4gICAgICAgIHRoaXMuX3Byb3RlY3RlZCA9IGZhbHNlO1xuICAgICAgICAvKipcbiAgICAgICAgICogVGhlIGxhc3QgdGltZSBrZXlmcmFtZSB3YXMgZXhlY3V0ZWQuXG4gICAgICAgICAqIE1haW50YWlucyBhIHJlbGF0aXZlbHkgZml4ZWQgaW50ZXJ2YWwgd2l0aCB0aGUgcHJldmlvdXMgdmFsdWUuXG4gICAgICAgICAqIEBtZW1iZXIge251bWJlcn1cbiAgICAgICAgICogQGRlZmF1bHQgLTFcbiAgICAgICAgICogQHByaXZhdGVcbiAgICAgICAgICovXG4gICAgICAgIHRoaXMuX2xhc3RGcmFtZSA9IC0xO1xuICAgICAgICAvKipcbiAgICAgICAgICogSW50ZXJuYWwgdGljayBtZXRob2QgYm91bmQgdG8gdGlja2VyIGluc3RhbmNlLlxuICAgICAgICAgKiBUaGlzIGlzIGJlY2F1c2UgaW4gZWFybHkgMjAxNSwgRnVuY3Rpb24uYmluZFxuICAgICAgICAgKiBpcyBzdGlsbCA2MCUgc2xvd2VyIGluIGhpZ2ggcGVyZm9ybWFuY2Ugc2NlbmFyaW9zLlxuICAgICAgICAgKiBBbHNvIHNlcGFyYXRpbmcgZnJhbWUgcmVxdWVzdHMgZnJvbSB1cGRhdGUgbWV0aG9kXG4gICAgICAgICAqIHNvIGxpc3RlbmVycyBtYXkgYmUgY2FsbGVkIGF0IGFueSB0aW1lIGFuZCB3aXRoXG4gICAgICAgICAqIGFueSBhbmltYXRpb24gQVBJLCBqdXN0IGludm9rZSB0aWNrZXIudXBkYXRlKHRpbWUpLlxuICAgICAgICAgKlxuICAgICAgICAgKiBAcHJpdmF0ZVxuICAgICAgICAgKiBAcGFyYW0ge251bWJlcn0gdGltZSAtIFRpbWUgc2luY2UgbGFzdCB0aWNrLlxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy5fdGljayA9IGZ1bmN0aW9uICh0aW1lKSB7XG4gICAgICAgICAgICBfdGhpcy5fcmVxdWVzdElkID0gbnVsbDtcbiAgICAgICAgICAgIGlmIChfdGhpcy5zdGFydGVkKSB7XG4gICAgICAgICAgICAgICAgLy8gSW52b2tlIGxpc3RlbmVycyBub3dcbiAgICAgICAgICAgICAgICBfdGhpcy51cGRhdGUodGltZSk7XG4gICAgICAgICAgICAgICAgLy8gTGlzdGVuZXIgc2lkZSBlZmZlY3RzIG1heSBoYXZlIG1vZGlmaWVkIHRpY2tlciBzdGF0ZS5cbiAgICAgICAgICAgICAgICBpZiAoX3RoaXMuc3RhcnRlZCAmJiBfdGhpcy5fcmVxdWVzdElkID09PSBudWxsICYmIF90aGlzLl9oZWFkLm5leHQpIHtcbiAgICAgICAgICAgICAgICAgICAgX3RoaXMuX3JlcXVlc3RJZCA9IHJlcXVlc3RBbmltYXRpb25GcmFtZShfdGhpcy5fdGljayk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBDb25kaXRpb25hbGx5IHJlcXVlc3RzIGEgbmV3IGFuaW1hdGlvbiBmcmFtZS5cbiAgICAgKiBJZiBhIGZyYW1lIGhhcyBub3QgYWxyZWFkeSBiZWVuIHJlcXVlc3RlZCwgYW5kIGlmIHRoZSBpbnRlcm5hbFxuICAgICAqIGVtaXR0ZXIgaGFzIGxpc3RlbmVycywgYSBuZXcgZnJhbWUgaXMgcmVxdWVzdGVkLlxuICAgICAqXG4gICAgICogQHByaXZhdGVcbiAgICAgKi9cbiAgICBUaWNrZXIucHJvdG90eXBlLl9yZXF1ZXN0SWZOZWVkZWQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGlmICh0aGlzLl9yZXF1ZXN0SWQgPT09IG51bGwgJiYgdGhpcy5faGVhZC5uZXh0KSB7XG4gICAgICAgICAgICAvLyBlbnN1cmUgY2FsbGJhY2tzIGdldCBjb3JyZWN0IGRlbHRhXG4gICAgICAgICAgICB0aGlzLmxhc3RUaW1lID0gcGVyZm9ybWFuY2Uubm93KCk7XG4gICAgICAgICAgICB0aGlzLl9sYXN0RnJhbWUgPSB0aGlzLmxhc3RUaW1lO1xuICAgICAgICAgICAgdGhpcy5fcmVxdWVzdElkID0gcmVxdWVzdEFuaW1hdGlvbkZyYW1lKHRoaXMuX3RpY2spO1xuICAgICAgICB9XG4gICAgfTtcbiAgICAvKipcbiAgICAgKiBDb25kaXRpb25hbGx5IGNhbmNlbHMgYSBwZW5kaW5nIGFuaW1hdGlvbiBmcmFtZS5cbiAgICAgKlxuICAgICAqIEBwcml2YXRlXG4gICAgICovXG4gICAgVGlja2VyLnByb3RvdHlwZS5fY2FuY2VsSWZOZWVkZWQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGlmICh0aGlzLl9yZXF1ZXN0SWQgIT09IG51bGwpIHtcbiAgICAgICAgICAgIGNhbmNlbEFuaW1hdGlvbkZyYW1lKHRoaXMuX3JlcXVlc3RJZCk7XG4gICAgICAgICAgICB0aGlzLl9yZXF1ZXN0SWQgPSBudWxsO1xuICAgICAgICB9XG4gICAgfTtcbiAgICAvKipcbiAgICAgKiBDb25kaXRpb25hbGx5IHJlcXVlc3RzIGEgbmV3IGFuaW1hdGlvbiBmcmFtZS5cbiAgICAgKiBJZiB0aGUgdGlja2VyIGhhcyBiZWVuIHN0YXJ0ZWQgaXQgY2hlY2tzIGlmIGEgZnJhbWUgaGFzIG5vdCBhbHJlYWR5XG4gICAgICogYmVlbiByZXF1ZXN0ZWQsIGFuZCBpZiB0aGUgaW50ZXJuYWwgZW1pdHRlciBoYXMgbGlzdGVuZXJzLiBJZiB0aGVzZVxuICAgICAqIGNvbmRpdGlvbnMgYXJlIG1ldCwgYSBuZXcgZnJhbWUgaXMgcmVxdWVzdGVkLiBJZiB0aGUgdGlja2VyIGhhcyBub3RcbiAgICAgKiBiZWVuIHN0YXJ0ZWQsIGJ1dCBhdXRvU3RhcnQgaXMgYHRydWVgLCB0aGVuIHRoZSB0aWNrZXIgc3RhcnRzIG5vdyxcbiAgICAgKiBhbmQgY29udGludWVzIHdpdGggdGhlIHByZXZpb3VzIGNvbmRpdGlvbnMgdG8gcmVxdWVzdCBhIG5ldyBmcmFtZS5cbiAgICAgKlxuICAgICAqIEBwcml2YXRlXG4gICAgICovXG4gICAgVGlja2VyLnByb3RvdHlwZS5fc3RhcnRJZlBvc3NpYmxlID0gZnVuY3Rpb24gKCkge1xuICAgICAgICBpZiAodGhpcy5zdGFydGVkKSB7XG4gICAgICAgICAgICB0aGlzLl9yZXF1ZXN0SWZOZWVkZWQoKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmICh0aGlzLmF1dG9TdGFydCkge1xuICAgICAgICAgICAgdGhpcy5zdGFydCgpO1xuICAgICAgICB9XG4gICAgfTtcbiAgICAvKipcbiAgICAgKiBSZWdpc3RlciBhIGhhbmRsZXIgZm9yIHRpY2sgZXZlbnRzLiBDYWxscyBjb250aW51b3VzbHkgdW5sZXNzXG4gICAgICogaXQgaXMgcmVtb3ZlZCBvciB0aGUgdGlja2VyIGlzIHN0b3BwZWQuXG4gICAgICpcbiAgICAgKiBAcGFyYW0ge0Z1bmN0aW9ufSBmbiAtIFRoZSBsaXN0ZW5lciBmdW5jdGlvbiB0byBiZSBhZGRlZCBmb3IgdXBkYXRlc1xuICAgICAqIEBwYXJhbSB7Kn0gW2NvbnRleHRdIC0gVGhlIGxpc3RlbmVyIGNvbnRleHRcbiAgICAgKiBAcGFyYW0ge251bWJlcn0gW3ByaW9yaXR5PVBJWEkuVVBEQVRFX1BSSU9SSVRZLk5PUk1BTF0gLSBUaGUgcHJpb3JpdHkgZm9yIGVtaXR0aW5nXG4gICAgICogQHJldHVybnMge1BJWEkuVGlja2VyfSBUaGlzIGluc3RhbmNlIG9mIGEgdGlja2VyXG4gICAgICovXG4gICAgVGlja2VyLnByb3RvdHlwZS5hZGQgPSBmdW5jdGlvbiAoZm4sIGNvbnRleHQsIHByaW9yaXR5KSB7XG4gICAgICAgIGlmIChwcmlvcml0eSA9PT0gdm9pZCAwKSB7IHByaW9yaXR5ID0gVVBEQVRFX1BSSU9SSVRZLk5PUk1BTDsgfVxuICAgICAgICByZXR1cm4gdGhpcy5fYWRkTGlzdGVuZXIobmV3IFRpY2tlckxpc3RlbmVyKGZuLCBjb250ZXh0LCBwcmlvcml0eSkpO1xuICAgIH07XG4gICAgLyoqXG4gICAgICogQWRkIGEgaGFuZGxlciBmb3IgdGhlIHRpY2sgZXZlbnQgd2hpY2ggaXMgb25seSBleGVjdXRlIG9uY2UuXG4gICAgICpcbiAgICAgKiBAcGFyYW0ge0Z1bmN0aW9ufSBmbiAtIFRoZSBsaXN0ZW5lciBmdW5jdGlvbiB0byBiZSBhZGRlZCBmb3Igb25lIHVwZGF0ZVxuICAgICAqIEBwYXJhbSB7Kn0gW2NvbnRleHRdIC0gVGhlIGxpc3RlbmVyIGNvbnRleHRcbiAgICAgKiBAcGFyYW0ge251bWJlcn0gW3ByaW9yaXR5PVBJWEkuVVBEQVRFX1BSSU9SSVRZLk5PUk1BTF0gLSBUaGUgcHJpb3JpdHkgZm9yIGVtaXR0aW5nXG4gICAgICogQHJldHVybnMge1BJWEkuVGlja2VyfSBUaGlzIGluc3RhbmNlIG9mIGEgdGlja2VyXG4gICAgICovXG4gICAgVGlja2VyLnByb3RvdHlwZS5hZGRPbmNlID0gZnVuY3Rpb24gKGZuLCBjb250ZXh0LCBwcmlvcml0eSkge1xuICAgICAgICBpZiAocHJpb3JpdHkgPT09IHZvaWQgMCkgeyBwcmlvcml0eSA9IFVQREFURV9QUklPUklUWS5OT1JNQUw7IH1cbiAgICAgICAgcmV0dXJuIHRoaXMuX2FkZExpc3RlbmVyKG5ldyBUaWNrZXJMaXN0ZW5lcihmbiwgY29udGV4dCwgcHJpb3JpdHksIHRydWUpKTtcbiAgICB9O1xuICAgIC8qKlxuICAgICAqIEludGVybmFsbHkgYWRkcyB0aGUgZXZlbnQgaGFuZGxlciBzbyB0aGF0IGl0IGNhbiBiZSBzb3J0ZWQgYnkgcHJpb3JpdHkuXG4gICAgICogUHJpb3JpdHkgYWxsb3dzIGNlcnRhaW4gaGFuZGxlciAodXNlciwgQW5pbWF0ZWRTcHJpdGUsIEludGVyYWN0aW9uKSB0byBiZSBydW5cbiAgICAgKiBiZWZvcmUgdGhlIHJlbmRlcmluZy5cbiAgICAgKlxuICAgICAqIEBwcml2YXRlXG4gICAgICogQHBhcmFtIHtUaWNrZXJMaXN0ZW5lcn0gbGlzdGVuZXIgLSBDdXJyZW50IGxpc3RlbmVyIGJlaW5nIGFkZGVkLlxuICAgICAqIEByZXR1cm5zIHtQSVhJLlRpY2tlcn0gVGhpcyBpbnN0YW5jZSBvZiBhIHRpY2tlclxuICAgICAqL1xuICAgIFRpY2tlci5wcm90b3R5cGUuX2FkZExpc3RlbmVyID0gZnVuY3Rpb24gKGxpc3RlbmVyKSB7XG4gICAgICAgIC8vIEZvciBhdHRhY2hpbmcgdG8gaGVhZFxuICAgICAgICB2YXIgY3VycmVudCA9IHRoaXMuX2hlYWQubmV4dDtcbiAgICAgICAgdmFyIHByZXZpb3VzID0gdGhpcy5faGVhZDtcbiAgICAgICAgLy8gQWRkIHRoZSBmaXJzdCBpdGVtXG4gICAgICAgIGlmICghY3VycmVudCkge1xuICAgICAgICAgICAgbGlzdGVuZXIuY29ubmVjdChwcmV2aW91cyk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAvLyBHbyBmcm9tIGhpZ2hlc3QgdG8gbG93ZXN0IHByaW9yaXR5XG4gICAgICAgICAgICB3aGlsZSAoY3VycmVudCkge1xuICAgICAgICAgICAgICAgIGlmIChsaXN0ZW5lci5wcmlvcml0eSA+IGN1cnJlbnQucHJpb3JpdHkpIHtcbiAgICAgICAgICAgICAgICAgICAgbGlzdGVuZXIuY29ubmVjdChwcmV2aW91cyk7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBwcmV2aW91cyA9IGN1cnJlbnQ7XG4gICAgICAgICAgICAgICAgY3VycmVudCA9IGN1cnJlbnQubmV4dDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIC8vIE5vdCB5ZXQgY29ubmVjdGVkXG4gICAgICAgICAgICBpZiAoIWxpc3RlbmVyLnByZXZpb3VzKSB7XG4gICAgICAgICAgICAgICAgbGlzdGVuZXIuY29ubmVjdChwcmV2aW91cyk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5fc3RhcnRJZlBvc3NpYmxlKCk7XG4gICAgICAgIHJldHVybiB0aGlzO1xuICAgIH07XG4gICAgLyoqXG4gICAgICogUmVtb3ZlcyBhbnkgaGFuZGxlcnMgbWF0Y2hpbmcgdGhlIGZ1bmN0aW9uIGFuZCBjb250ZXh0IHBhcmFtZXRlcnMuXG4gICAgICogSWYgbm8gaGFuZGxlcnMgYXJlIGxlZnQgYWZ0ZXIgcmVtb3ZpbmcsIHRoZW4gaXQgY2FuY2VscyB0aGUgYW5pbWF0aW9uIGZyYW1lLlxuICAgICAqXG4gICAgICogQHBhcmFtIHtGdW5jdGlvbn0gZm4gLSBUaGUgbGlzdGVuZXIgZnVuY3Rpb24gdG8gYmUgcmVtb3ZlZFxuICAgICAqIEBwYXJhbSB7Kn0gW2NvbnRleHRdIC0gVGhlIGxpc3RlbmVyIGNvbnRleHQgdG8gYmUgcmVtb3ZlZFxuICAgICAqIEByZXR1cm5zIHtQSVhJLlRpY2tlcn0gVGhpcyBpbnN0YW5jZSBvZiBhIHRpY2tlclxuICAgICAqL1xuICAgIFRpY2tlci5wcm90b3R5cGUucmVtb3ZlID0gZnVuY3Rpb24gKGZuLCBjb250ZXh0KSB7XG4gICAgICAgIHZhciBsaXN0ZW5lciA9IHRoaXMuX2hlYWQubmV4dDtcbiAgICAgICAgd2hpbGUgKGxpc3RlbmVyKSB7XG4gICAgICAgICAgICAvLyBXZSBmb3VuZCBhIG1hdGNoLCBsZXRzIHJlbW92ZSBpdFxuICAgICAgICAgICAgLy8gbm8gYnJlYWsgdG8gZGVsZXRlIGFsbCBwb3NzaWJsZSBtYXRjaGVzXG4gICAgICAgICAgICAvLyBpbmNhc2UgYSBsaXN0ZW5lciB3YXMgYWRkZWQgMisgdGltZXNcbiAgICAgICAgICAgIGlmIChsaXN0ZW5lci5tYXRjaChmbiwgY29udGV4dCkpIHtcbiAgICAgICAgICAgICAgICBsaXN0ZW5lciA9IGxpc3RlbmVyLmRlc3Ryb3koKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIGxpc3RlbmVyID0gbGlzdGVuZXIubmV4dDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBpZiAoIXRoaXMuX2hlYWQubmV4dCkge1xuICAgICAgICAgICAgdGhpcy5fY2FuY2VsSWZOZWVkZWQoKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdGhpcztcbiAgICB9O1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShUaWNrZXIucHJvdG90eXBlLCBcImNvdW50XCIsIHtcbiAgICAgICAgLyoqXG4gICAgICAgICAqIFRoZSBudW1iZXIgb2YgbGlzdGVuZXJzIG9uIHRoaXMgdGlja2VyLCBjYWxjdWxhdGVkIGJ5IHdhbGtpbmcgdGhyb3VnaCBsaW5rZWQgbGlzdFxuICAgICAgICAgKlxuICAgICAgICAgKiBAcmVhZG9ubHlcbiAgICAgICAgICogQG1lbWJlciB7bnVtYmVyfVxuICAgICAgICAgKi9cbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICBpZiAoIXRoaXMuX2hlYWQpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gMDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHZhciBjb3VudCA9IDA7XG4gICAgICAgICAgICB2YXIgY3VycmVudCA9IHRoaXMuX2hlYWQ7XG4gICAgICAgICAgICB3aGlsZSAoKGN1cnJlbnQgPSBjdXJyZW50Lm5leHQpKSB7XG4gICAgICAgICAgICAgICAgY291bnQrKztcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiBjb3VudDtcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogZmFsc2UsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIC8qKlxuICAgICAqIFN0YXJ0cyB0aGUgdGlja2VyLiBJZiB0aGUgdGlja2VyIGhhcyBsaXN0ZW5lcnNcbiAgICAgKiBhIG5ldyBhbmltYXRpb24gZnJhbWUgaXMgcmVxdWVzdGVkIGF0IHRoaXMgcG9pbnQuXG4gICAgICovXG4gICAgVGlja2VyLnByb3RvdHlwZS5zdGFydCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgaWYgKCF0aGlzLnN0YXJ0ZWQpIHtcbiAgICAgICAgICAgIHRoaXMuc3RhcnRlZCA9IHRydWU7XG4gICAgICAgICAgICB0aGlzLl9yZXF1ZXN0SWZOZWVkZWQoKTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgLyoqXG4gICAgICogU3RvcHMgdGhlIHRpY2tlci4gSWYgdGhlIHRpY2tlciBoYXMgcmVxdWVzdGVkXG4gICAgICogYW4gYW5pbWF0aW9uIGZyYW1lIGl0IGlzIGNhbmNlbGVkIGF0IHRoaXMgcG9pbnQuXG4gICAgICovXG4gICAgVGlja2VyLnByb3RvdHlwZS5zdG9wID0gZnVuY3Rpb24gKCkge1xuICAgICAgICBpZiAodGhpcy5zdGFydGVkKSB7XG4gICAgICAgICAgICB0aGlzLnN0YXJ0ZWQgPSBmYWxzZTtcbiAgICAgICAgICAgIHRoaXMuX2NhbmNlbElmTmVlZGVkKCk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIC8qKlxuICAgICAqIERlc3Ryb3kgdGhlIHRpY2tlciBhbmQgZG9uJ3QgdXNlIGFmdGVyIHRoaXMuIENhbGxpbmdcbiAgICAgKiB0aGlzIG1ldGhvZCByZW1vdmVzIGFsbCByZWZlcmVuY2VzIHRvIGludGVybmFsIGV2ZW50cy5cbiAgICAgKi9cbiAgICBUaWNrZXIucHJvdG90eXBlLmRlc3Ryb3kgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGlmICghdGhpcy5fcHJvdGVjdGVkKSB7XG4gICAgICAgICAgICB0aGlzLnN0b3AoKTtcbiAgICAgICAgICAgIHZhciBsaXN0ZW5lciA9IHRoaXMuX2hlYWQubmV4dDtcbiAgICAgICAgICAgIHdoaWxlIChsaXN0ZW5lcikge1xuICAgICAgICAgICAgICAgIGxpc3RlbmVyID0gbGlzdGVuZXIuZGVzdHJveSh0cnVlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRoaXMuX2hlYWQuZGVzdHJveSgpO1xuICAgICAgICAgICAgdGhpcy5faGVhZCA9IG51bGw7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIC8qKlxuICAgICAqIFRyaWdnZXJzIGFuIHVwZGF0ZS4gQW4gdXBkYXRlIGVudGFpbHMgc2V0dGluZyB0aGVcbiAgICAgKiBjdXJyZW50IHtAbGluayBQSVhJLlRpY2tlciNlbGFwc2VkTVN9LFxuICAgICAqIHRoZSBjdXJyZW50IHtAbGluayBQSVhJLlRpY2tlciNkZWx0YVRpbWV9LFxuICAgICAqIGludm9raW5nIGFsbCBsaXN0ZW5lcnMgd2l0aCBjdXJyZW50IGRlbHRhVGltZSxcbiAgICAgKiBhbmQgdGhlbiBmaW5hbGx5IHNldHRpbmcge0BsaW5rIFBJWEkuVGlja2VyI2xhc3RUaW1lfVxuICAgICAqIHdpdGggdGhlIHZhbHVlIG9mIGN1cnJlbnRUaW1lIHRoYXQgd2FzIHByb3ZpZGVkLlxuICAgICAqIFRoaXMgbWV0aG9kIHdpbGwgYmUgY2FsbGVkIGF1dG9tYXRpY2FsbHkgYnkgYW5pbWF0aW9uXG4gICAgICogZnJhbWUgY2FsbGJhY2tzIGlmIHRoZSB0aWNrZXIgaW5zdGFuY2UgaGFzIGJlZW4gc3RhcnRlZFxuICAgICAqIGFuZCBsaXN0ZW5lcnMgYXJlIGFkZGVkLlxuICAgICAqXG4gICAgICogQHBhcmFtIHtudW1iZXJ9IFtjdXJyZW50VGltZT1wZXJmb3JtYW5jZS5ub3coKV0gLSB0aGUgY3VycmVudCB0aW1lIG9mIGV4ZWN1dGlvblxuICAgICAqL1xuICAgIFRpY2tlci5wcm90b3R5cGUudXBkYXRlID0gZnVuY3Rpb24gKGN1cnJlbnRUaW1lKSB7XG4gICAgICAgIGlmIChjdXJyZW50VGltZSA9PT0gdm9pZCAwKSB7IGN1cnJlbnRUaW1lID0gcGVyZm9ybWFuY2Uubm93KCk7IH1cbiAgICAgICAgdmFyIGVsYXBzZWRNUztcbiAgICAgICAgLy8gSWYgdGhlIGRpZmZlcmVuY2UgaW4gdGltZSBpcyB6ZXJvIG9yIG5lZ2F0aXZlLCB3ZSBpZ25vcmUgbW9zdCBvZiB0aGUgd29yayBkb25lIGhlcmUuXG4gICAgICAgIC8vIElmIHRoZXJlIGlzIG5vIHZhbGlkIGRpZmZlcmVuY2UsIHRoZW4gc2hvdWxkIGJlIG5vIHJlYXNvbiB0byBsZXQgYW55b25lIGtub3cgYWJvdXQgaXQuXG4gICAgICAgIC8vIEEgemVybyBkZWx0YSwgaXMgZXhhY3RseSB0aGF0LCBub3RoaW5nIHNob3VsZCB1cGRhdGUuXG4gICAgICAgIC8vXG4gICAgICAgIC8vIFRoZSBkaWZmZXJlbmNlIGluIHRpbWUgY2FuIGJlIG5lZ2F0aXZlLCBhbmQgbm8gdGhpcyBkb2VzIG5vdCBtZWFuIHRpbWUgdHJhdmVsaW5nLlxuICAgICAgICAvLyBUaGlzIGNhbiBiZSB0aGUgcmVzdWx0IG9mIGEgcmFjZSBjb25kaXRpb24gYmV0d2VlbiB3aGVuIGFuIGFuaW1hdGlvbiBmcmFtZSBpcyByZXF1ZXN0ZWRcbiAgICAgICAgLy8gb24gdGhlIGN1cnJlbnQgSmF2YVNjcmlwdCBlbmdpbmUgZXZlbnQgbG9vcCwgYW5kIHdoZW4gdGhlIHRpY2tlcidzIHN0YXJ0IG1ldGhvZCBpcyBpbnZva2VkXG4gICAgICAgIC8vICh3aGljaCBpbnZva2VzIHRoZSBpbnRlcm5hbCBfcmVxdWVzdElmTmVlZGVkIG1ldGhvZCkuIElmIGEgZnJhbWUgaXMgcmVxdWVzdGVkIGJlZm9yZVxuICAgICAgICAvLyBfcmVxdWVzdElmTmVlZGVkIGlzIGludm9rZWQsIHRoZW4gdGhlIGNhbGxiYWNrIGZvciB0aGUgYW5pbWF0aW9uIGZyYW1lIHRoZSB0aWNrZXIgcmVxdWVzdHMsXG4gICAgICAgIC8vIGNhbiByZWNlaXZlIGEgdGltZSBhcmd1bWVudCB0aGF0IGNhbiBiZSBsZXNzIHRoYW4gdGhlIGxhc3RUaW1lIHZhbHVlIHRoYXQgd2FzIHNldCB3aXRoaW5cbiAgICAgICAgLy8gX3JlcXVlc3RJZk5lZWRlZC4gVGhpcyBkaWZmZXJlbmNlIGlzIGluIG1pY3Jvc2Vjb25kcywgYnV0IHRoaXMgaXMgZW5vdWdoIHRvIGNhdXNlIHByb2JsZW1zLlxuICAgICAgICAvL1xuICAgICAgICAvLyBUaGlzIGNoZWNrIGNvdmVycyB0aGlzIGJyb3dzZXIgZW5naW5lIHRpbWluZyBpc3N1ZSwgYXMgd2VsbCBhcyBpZiBjb25zdW1lcnMgcGFzcyBhbiBpbnZhbGlkXG4gICAgICAgIC8vIGN1cnJlbnRUaW1lIHZhbHVlLiBUaGlzIG1heSBoYXBwZW4gaWYgY29uc3VtZXJzIG9wdC1vdXQgb2YgdGhlIGF1dG9TdGFydCwgYW5kIHVwZGF0ZSB0aGVtc2VsdmVzLlxuICAgICAgICBpZiAoY3VycmVudFRpbWUgPiB0aGlzLmxhc3RUaW1lKSB7XG4gICAgICAgICAgICAvLyBTYXZlIHVuY2FwcGVkIGVsYXBzZWRNUyBmb3IgbWVhc3VyZW1lbnRcbiAgICAgICAgICAgIGVsYXBzZWRNUyA9IHRoaXMuZWxhcHNlZE1TID0gY3VycmVudFRpbWUgLSB0aGlzLmxhc3RUaW1lO1xuICAgICAgICAgICAgLy8gY2FwIHRoZSBtaWxsaXNlY29uZHMgZWxhcHNlZCB1c2VkIGZvciBkZWx0YVRpbWVcbiAgICAgICAgICAgIGlmIChlbGFwc2VkTVMgPiB0aGlzLl9tYXhFbGFwc2VkTVMpIHtcbiAgICAgICAgICAgICAgICBlbGFwc2VkTVMgPSB0aGlzLl9tYXhFbGFwc2VkTVM7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbGFwc2VkTVMgKj0gdGhpcy5zcGVlZDtcbiAgICAgICAgICAgIC8vIElmIG5vdCBlbm91Z2ggdGltZSBoYXMgcGFzc2VkLCBleGl0IHRoZSBmdW5jdGlvbi5cbiAgICAgICAgICAgIC8vIEdldCByZWFkeSBmb3IgbmV4dCBmcmFtZSBieSBzZXR0aW5nIF9sYXN0RnJhbWUsIGJ1dCBiYXNlZCBvbiBfbWluRWxhcHNlZE1TXG4gICAgICAgICAgICAvLyBhZGp1c3RtZW50IHRvIGVuc3VyZSBhIHJlbGF0aXZlbHkgc3RhYmxlIGludGVydmFsLlxuICAgICAgICAgICAgaWYgKHRoaXMuX21pbkVsYXBzZWRNUykge1xuICAgICAgICAgICAgICAgIHZhciBkZWx0YSA9IGN1cnJlbnRUaW1lIC0gdGhpcy5fbGFzdEZyYW1lIHwgMDtcbiAgICAgICAgICAgICAgICBpZiAoZGVsdGEgPCB0aGlzLl9taW5FbGFwc2VkTVMpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB0aGlzLl9sYXN0RnJhbWUgPSBjdXJyZW50VGltZSAtIChkZWx0YSAlIHRoaXMuX21pbkVsYXBzZWRNUyk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0aGlzLmRlbHRhTVMgPSBlbGFwc2VkTVM7XG4gICAgICAgICAgICB0aGlzLmRlbHRhVGltZSA9IHRoaXMuZGVsdGFNUyAqIHNldHRpbmdzLlRBUkdFVF9GUE1TO1xuICAgICAgICAgICAgLy8gQ2FjaGUgYSBsb2NhbCByZWZlcmVuY2UsIGluLWNhc2UgdGlja2VyIGlzIGRlc3Ryb3llZFxuICAgICAgICAgICAgLy8gZHVyaW5nIHRoZSBlbWl0LCB3ZSBjYW4gc3RpbGwgY2hlY2sgZm9yIGhlYWQubmV4dFxuICAgICAgICAgICAgdmFyIGhlYWQgPSB0aGlzLl9oZWFkO1xuICAgICAgICAgICAgLy8gSW52b2tlIGxpc3RlbmVycyBhZGRlZCB0byBpbnRlcm5hbCBlbWl0dGVyXG4gICAgICAgICAgICB2YXIgbGlzdGVuZXIgPSBoZWFkLm5leHQ7XG4gICAgICAgICAgICB3aGlsZSAobGlzdGVuZXIpIHtcbiAgICAgICAgICAgICAgICBsaXN0ZW5lciA9IGxpc3RlbmVyLmVtaXQodGhpcy5kZWx0YVRpbWUpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKCFoZWFkLm5leHQpIHtcbiAgICAgICAgICAgICAgICB0aGlzLl9jYW5jZWxJZk5lZWRlZCgpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgdGhpcy5kZWx0YVRpbWUgPSB0aGlzLmRlbHRhTVMgPSB0aGlzLmVsYXBzZWRNUyA9IDA7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5sYXN0VGltZSA9IGN1cnJlbnRUaW1lO1xuICAgIH07XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KFRpY2tlci5wcm90b3R5cGUsIFwiRlBTXCIsIHtcbiAgICAgICAgLyoqXG4gICAgICAgICAqIFRoZSBmcmFtZXMgcGVyIHNlY29uZCBhdCB3aGljaCB0aGlzIHRpY2tlciBpcyBydW5uaW5nLlxuICAgICAgICAgKiBUaGUgZGVmYXVsdCBpcyBhcHByb3hpbWF0ZWx5IDYwIGluIG1vc3QgbW9kZXJuIGJyb3dzZXJzLlxuICAgICAgICAgKiAqKk5vdGU6KiogVGhpcyBkb2VzIG5vdCBmYWN0b3IgaW4gdGhlIHZhbHVlIG9mXG4gICAgICAgICAqIHtAbGluayBQSVhJLlRpY2tlciNzcGVlZH0sIHdoaWNoIGlzIHNwZWNpZmljXG4gICAgICAgICAqIHRvIHNjYWxpbmcge0BsaW5rIFBJWEkuVGlja2VyI2RlbHRhVGltZX0uXG4gICAgICAgICAqXG4gICAgICAgICAqIEBtZW1iZXIge251bWJlcn1cbiAgICAgICAgICogQHJlYWRvbmx5XG4gICAgICAgICAqL1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiAxMDAwIC8gdGhpcy5lbGFwc2VkTVM7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IGZhbHNlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoVGlja2VyLnByb3RvdHlwZSwgXCJtaW5GUFNcIiwge1xuICAgICAgICAvKipcbiAgICAgICAgICogTWFuYWdlcyB0aGUgbWF4aW11bSBhbW91bnQgb2YgbWlsbGlzZWNvbmRzIGFsbG93ZWQgdG9cbiAgICAgICAgICogZWxhcHNlIGJldHdlZW4gaW52b2tpbmcge0BsaW5rIFBJWEkuVGlja2VyI3VwZGF0ZX0uXG4gICAgICAgICAqIFRoaXMgdmFsdWUgaXMgdXNlZCB0byBjYXAge0BsaW5rIFBJWEkuVGlja2VyI2RlbHRhVGltZX0sXG4gICAgICAgICAqIGJ1dCBkb2VzIG5vdCBlZmZlY3QgdGhlIG1lYXN1cmVkIHZhbHVlIG9mIHtAbGluayBQSVhJLlRpY2tlciNGUFN9LlxuICAgICAgICAgKiBXaGVuIHNldHRpbmcgdGhpcyBwcm9wZXJ0eSBpdCBpcyBjbGFtcGVkIHRvIGEgdmFsdWUgYmV0d2VlblxuICAgICAgICAgKiBgMGAgYW5kIGBQSVhJLnNldHRpbmdzLlRBUkdFVF9GUE1TICogMTAwMGAuXG4gICAgICAgICAqXG4gICAgICAgICAqIEBtZW1iZXIge251bWJlcn1cbiAgICAgICAgICogQGRlZmF1bHQgMTBcbiAgICAgICAgICovXG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIDEwMDAgLyB0aGlzLl9tYXhFbGFwc2VkTVM7XG4gICAgICAgIH0sXG4gICAgICAgIHNldDogZnVuY3Rpb24gKGZwcykge1xuICAgICAgICAgICAgLy8gTWluaW11bSBtdXN0IGJlIGJlbG93IHRoZSBtYXhGUFNcbiAgICAgICAgICAgIHZhciBtaW5GUFMgPSBNYXRoLm1pbih0aGlzLm1heEZQUywgZnBzKTtcbiAgICAgICAgICAgIC8vIE11c3QgYmUgYXQgbGVhc3QgMCwgYnV0IGJlbG93IDEgLyBzZXR0aW5ncy5UQVJHRVRfRlBNU1xuICAgICAgICAgICAgdmFyIG1pbkZQTVMgPSBNYXRoLm1pbihNYXRoLm1heCgwLCBtaW5GUFMpIC8gMTAwMCwgc2V0dGluZ3MuVEFSR0VUX0ZQTVMpO1xuICAgICAgICAgICAgdGhpcy5fbWF4RWxhcHNlZE1TID0gMSAvIG1pbkZQTVM7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IGZhbHNlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoVGlja2VyLnByb3RvdHlwZSwgXCJtYXhGUFNcIiwge1xuICAgICAgICAvKipcbiAgICAgICAgICogTWFuYWdlcyB0aGUgbWluaW11bSBhbW91bnQgb2YgbWlsbGlzZWNvbmRzIHJlcXVpcmVkIHRvXG4gICAgICAgICAqIGVsYXBzZSBiZXR3ZWVuIGludm9raW5nIHtAbGluayBQSVhJLlRpY2tlciN1cGRhdGV9LlxuICAgICAgICAgKiBUaGlzIHdpbGwgZWZmZWN0IHRoZSBtZWFzdXJlZCB2YWx1ZSBvZiB7QGxpbmsgUElYSS5UaWNrZXIjRlBTfS5cbiAgICAgICAgICogSWYgaXQgaXMgc2V0IHRvIGAwYCwgdGhlbiB0aGVyZSBpcyBubyBsaW1pdDsgUGl4aUpTIHdpbGwgcmVuZGVyIGFzIG1hbnkgZnJhbWVzIGFzIGl0IGNhbi5cbiAgICAgICAgICogT3RoZXJ3aXNlIGl0IHdpbGwgYmUgYXQgbGVhc3QgYG1pbkZQU2BcbiAgICAgICAgICpcbiAgICAgICAgICogQG1lbWJlciB7bnVtYmVyfVxuICAgICAgICAgKiBAZGVmYXVsdCAwXG4gICAgICAgICAqL1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIGlmICh0aGlzLl9taW5FbGFwc2VkTVMpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gTWF0aC5yb3VuZCgxMDAwIC8gdGhpcy5fbWluRWxhcHNlZE1TKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiAwO1xuICAgICAgICB9LFxuICAgICAgICBzZXQ6IGZ1bmN0aW9uIChmcHMpIHtcbiAgICAgICAgICAgIGlmIChmcHMgPT09IDApIHtcbiAgICAgICAgICAgICAgICB0aGlzLl9taW5FbGFwc2VkTVMgPSAwO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgLy8gTWF4IG11c3QgYmUgYXQgbGVhc3QgdGhlIG1pbkZQU1xuICAgICAgICAgICAgICAgIHZhciBtYXhGUFMgPSBNYXRoLm1heCh0aGlzLm1pbkZQUywgZnBzKTtcbiAgICAgICAgICAgICAgICB0aGlzLl9taW5FbGFwc2VkTVMgPSAxIC8gKG1heEZQUyAvIDEwMDApO1xuICAgICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiBmYWxzZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KFRpY2tlciwgXCJzaGFyZWRcIiwge1xuICAgICAgICAvKipcbiAgICAgICAgICogVGhlIHNoYXJlZCB0aWNrZXIgaW5zdGFuY2UgdXNlZCBieSB7QGxpbmsgUElYSS5BbmltYXRlZFNwcml0ZX0gYW5kIGJ5XG4gICAgICAgICAqIHtAbGluayBQSVhJLlZpZGVvUmVzb3VyY2V9IHRvIHVwZGF0ZSBhbmltYXRpb24gZnJhbWVzIC8gdmlkZW8gdGV4dHVyZXMuXG4gICAgICAgICAqXG4gICAgICAgICAqIEl0IG1heSBhbHNvIGJlIHVzZWQgYnkge0BsaW5rIFBJWEkuQXBwbGljYXRpb259IGlmIGNyZWF0ZWQgd2l0aCB0aGUgYHNoYXJlZFRpY2tlcmAgb3B0aW9uIHByb3BlcnR5IHNldCB0byB0cnVlLlxuICAgICAgICAgKlxuICAgICAgICAgKiBUaGUgcHJvcGVydHkge0BsaW5rIFBJWEkuVGlja2VyI2F1dG9TdGFydH0gaXMgc2V0IHRvIGB0cnVlYCBmb3IgdGhpcyBpbnN0YW5jZS5cbiAgICAgICAgICogUGxlYXNlIGZvbGxvdyB0aGUgZXhhbXBsZXMgZm9yIHVzYWdlLCBpbmNsdWRpbmcgaG93IHRvIG9wdC1vdXQgb2YgYXV0by1zdGFydGluZyB0aGUgc2hhcmVkIHRpY2tlci5cbiAgICAgICAgICpcbiAgICAgICAgICogQGV4YW1wbGVcbiAgICAgICAgICogbGV0IHRpY2tlciA9IFBJWEkuVGlja2VyLnNoYXJlZDtcbiAgICAgICAgICogLy8gU2V0IHRoaXMgdG8gcHJldmVudCBzdGFydGluZyB0aGlzIHRpY2tlciB3aGVuIGxpc3RlbmVycyBhcmUgYWRkZWQuXG4gICAgICAgICAqIC8vIEJ5IGRlZmF1bHQgdGhpcyBpcyB0cnVlIG9ubHkgZm9yIHRoZSBQSVhJLlRpY2tlci5zaGFyZWQgaW5zdGFuY2UuXG4gICAgICAgICAqIHRpY2tlci5hdXRvU3RhcnQgPSBmYWxzZTtcbiAgICAgICAgICogLy8gRllJLCBjYWxsIHRoaXMgdG8gZW5zdXJlIHRoZSB0aWNrZXIgaXMgc3RvcHBlZC4gSXQgc2hvdWxkIGJlIHN0b3BwZWRcbiAgICAgICAgICogLy8gaWYgeW91IGhhdmUgbm90IGF0dGVtcHRlZCB0byByZW5kZXIgYW55dGhpbmcgeWV0LlxuICAgICAgICAgKiB0aWNrZXIuc3RvcCgpO1xuICAgICAgICAgKiAvLyBDYWxsIHRoaXMgd2hlbiB5b3UgYXJlIHJlYWR5IGZvciBhIHJ1bm5pbmcgc2hhcmVkIHRpY2tlci5cbiAgICAgICAgICogdGlja2VyLnN0YXJ0KCk7XG4gICAgICAgICAqXG4gICAgICAgICAqIEBleGFtcGxlXG4gICAgICAgICAqIC8vIFlvdSBtYXkgdXNlIHRoZSBzaGFyZWQgdGlja2VyIHRvIHJlbmRlci4uLlxuICAgICAgICAgKiBsZXQgcmVuZGVyZXIgPSBQSVhJLmF1dG9EZXRlY3RSZW5kZXJlcigpO1xuICAgICAgICAgKiBsZXQgc3RhZ2UgPSBuZXcgUElYSS5Db250YWluZXIoKTtcbiAgICAgICAgICogZG9jdW1lbnQuYm9keS5hcHBlbmRDaGlsZChyZW5kZXJlci52aWV3KTtcbiAgICAgICAgICogdGlja2VyLmFkZChmdW5jdGlvbiAodGltZSkge1xuICAgICAgICAgKiAgICAgcmVuZGVyZXIucmVuZGVyKHN0YWdlKTtcbiAgICAgICAgICogfSk7XG4gICAgICAgICAqXG4gICAgICAgICAqIEBleGFtcGxlXG4gICAgICAgICAqIC8vIE9yIHlvdSBjYW4ganVzdCB1cGRhdGUgaXQgbWFudWFsbHkuXG4gICAgICAgICAqIHRpY2tlci5hdXRvU3RhcnQgPSBmYWxzZTtcbiAgICAgICAgICogdGlja2VyLnN0b3AoKTtcbiAgICAgICAgICogZnVuY3Rpb24gYW5pbWF0ZSh0aW1lKSB7XG4gICAgICAgICAqICAgICB0aWNrZXIudXBkYXRlKHRpbWUpO1xuICAgICAgICAgKiAgICAgcmVuZGVyZXIucmVuZGVyKHN0YWdlKTtcbiAgICAgICAgICogICAgIHJlcXVlc3RBbmltYXRpb25GcmFtZShhbmltYXRlKTtcbiAgICAgICAgICogfVxuICAgICAgICAgKiBhbmltYXRlKHBlcmZvcm1hbmNlLm5vdygpKTtcbiAgICAgICAgICpcbiAgICAgICAgICogQG1lbWJlciB7UElYSS5UaWNrZXJ9XG4gICAgICAgICAqIEBzdGF0aWNcbiAgICAgICAgICovXG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgaWYgKCFUaWNrZXIuX3NoYXJlZCkge1xuICAgICAgICAgICAgICAgIHZhciBzaGFyZWQgPSBUaWNrZXIuX3NoYXJlZCA9IG5ldyBUaWNrZXIoKTtcbiAgICAgICAgICAgICAgICBzaGFyZWQuYXV0b1N0YXJ0ID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICBzaGFyZWQuX3Byb3RlY3RlZCA9IHRydWU7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gVGlja2VyLl9zaGFyZWQ7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IGZhbHNlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoVGlja2VyLCBcInN5c3RlbVwiLCB7XG4gICAgICAgIC8qKlxuICAgICAgICAgKiBUaGUgc3lzdGVtIHRpY2tlciBpbnN0YW5jZSB1c2VkIGJ5IHtAbGluayBQSVhJLkludGVyYWN0aW9uTWFuYWdlcn0gYW5kIGJ5XG4gICAgICAgICAqIHtAbGluayBQSVhJLkJhc2VQcmVwYXJlfSBmb3IgY29yZSB0aW1pbmcgZnVuY3Rpb25hbGl0eSB0aGF0IHNob3VsZG4ndCB1c3VhbGx5IG5lZWQgdG8gYmUgcGF1c2VkLFxuICAgICAgICAgKiB1bmxpa2UgdGhlIGBzaGFyZWRgIHRpY2tlciB3aGljaCBkcml2ZXMgdmlzdWFsIGFuaW1hdGlvbnMgYW5kIHJlbmRlcmluZyB3aGljaCBtYXkgd2FudCB0byBiZSBwYXVzZWQuXG4gICAgICAgICAqXG4gICAgICAgICAqIFRoZSBwcm9wZXJ0eSB7QGxpbmsgUElYSS5UaWNrZXIjYXV0b1N0YXJ0fSBpcyBzZXQgdG8gYHRydWVgIGZvciB0aGlzIGluc3RhbmNlLlxuICAgICAgICAgKlxuICAgICAgICAgKiBAbWVtYmVyIHtQSVhJLlRpY2tlcn1cbiAgICAgICAgICogQHN0YXRpY1xuICAgICAgICAgKi9cbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICBpZiAoIVRpY2tlci5fc3lzdGVtKSB7XG4gICAgICAgICAgICAgICAgdmFyIHN5c3RlbSA9IFRpY2tlci5fc3lzdGVtID0gbmV3IFRpY2tlcigpO1xuICAgICAgICAgICAgICAgIHN5c3RlbS5hdXRvU3RhcnQgPSB0cnVlO1xuICAgICAgICAgICAgICAgIHN5c3RlbS5fcHJvdGVjdGVkID0gdHJ1ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiBUaWNrZXIuX3N5c3RlbTtcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogZmFsc2UsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIHJldHVybiBUaWNrZXI7XG59KCkpO1xuXG4vKipcbiAqIE1pZGRsZXdhcmUgZm9yIGZvciBBcHBsaWNhdGlvbiBUaWNrZXIuXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCB7VGlja2VyUGx1Z2lufSBmcm9tICdAcGl4aS90aWNrZXInO1xuICogaW1wb3J0IHtBcHBsaWNhdGlvbn0gZnJvbSAnQHBpeGkvYXBwJztcbiAqIEFwcGxpY2F0aW9uLnJlZ2lzdGVyUGx1Z2luKFRpY2tlclBsdWdpbik7XG4gKlxuICogQGNsYXNzXG4gKiBAbWVtYmVyb2YgUElYSVxuICovXG52YXIgVGlja2VyUGx1Z2luID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkge1xuICAgIGZ1bmN0aW9uIFRpY2tlclBsdWdpbigpIHtcbiAgICB9XG4gICAgLyoqXG4gICAgICogSW5pdGlhbGl6ZSB0aGUgcGx1Z2luIHdpdGggc2NvcGUgb2YgYXBwbGljYXRpb24gaW5zdGFuY2VcbiAgICAgKlxuICAgICAqIEBzdGF0aWNcbiAgICAgKiBAcHJpdmF0ZVxuICAgICAqIEBwYXJhbSB7b2JqZWN0fSBbb3B0aW9uc10gLSBTZWUgYXBwbGljYXRpb24gb3B0aW9uc1xuICAgICAqL1xuICAgIFRpY2tlclBsdWdpbi5pbml0ID0gZnVuY3Rpb24gKG9wdGlvbnMpIHtcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcbiAgICAgICAgLy8gU2V0IGRlZmF1bHRcbiAgICAgICAgb3B0aW9ucyA9IE9iamVjdC5hc3NpZ24oe1xuICAgICAgICAgICAgYXV0b1N0YXJ0OiB0cnVlLFxuICAgICAgICAgICAgc2hhcmVkVGlja2VyOiBmYWxzZSxcbiAgICAgICAgfSwgb3B0aW9ucyk7XG4gICAgICAgIC8vIENyZWF0ZSB0aWNrZXIgc2V0dGVyXG4gICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0aGlzLCAndGlja2VyJywge1xuICAgICAgICAgICAgc2V0OiBmdW5jdGlvbiAodGlja2VyKSB7XG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuX3RpY2tlcikge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLl90aWNrZXIucmVtb3ZlKHRoaXMucmVuZGVyLCB0aGlzKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgdGhpcy5fdGlja2VyID0gdGlja2VyO1xuICAgICAgICAgICAgICAgIGlmICh0aWNrZXIpIHtcbiAgICAgICAgICAgICAgICAgICAgdGlja2VyLmFkZCh0aGlzLnJlbmRlciwgdGhpcywgVVBEQVRFX1BSSU9SSVRZLkxPVyk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLl90aWNrZXI7XG4gICAgICAgICAgICB9LFxuICAgICAgICB9KTtcbiAgICAgICAgLyoqXG4gICAgICAgICAqIENvbnZlbmllbmNlIG1ldGhvZCBmb3Igc3RvcHBpbmcgdGhlIHJlbmRlci5cbiAgICAgICAgICpcbiAgICAgICAgICogQG1ldGhvZCBQSVhJLkFwcGxpY2F0aW9uI3N0b3BcbiAgICAgICAgICovXG4gICAgICAgIHRoaXMuc3RvcCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIF90aGlzLl90aWNrZXIuc3RvcCgpO1xuICAgICAgICB9O1xuICAgICAgICAvKipcbiAgICAgICAgICogQ29udmVuaWVuY2UgbWV0aG9kIGZvciBzdGFydGluZyB0aGUgcmVuZGVyLlxuICAgICAgICAgKlxuICAgICAgICAgKiBAbWV0aG9kIFBJWEkuQXBwbGljYXRpb24jc3RhcnRcbiAgICAgICAgICovXG4gICAgICAgIHRoaXMuc3RhcnQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICBfdGhpcy5fdGlja2VyLnN0YXJ0KCk7XG4gICAgICAgIH07XG4gICAgICAgIC8qKlxuICAgICAgICAgKiBJbnRlcm5hbCByZWZlcmVuY2UgdG8gdGhlIHRpY2tlci5cbiAgICAgICAgICpcbiAgICAgICAgICogQHR5cGUge1BJWEkuVGlja2VyfVxuICAgICAgICAgKiBAbmFtZSBfdGlja2VyXG4gICAgICAgICAqIEBtZW1iZXJvZiBQSVhJLkFwcGxpY2F0aW9uI1xuICAgICAgICAgKiBAcHJpdmF0ZVxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy5fdGlja2VyID0gbnVsbDtcbiAgICAgICAgLyoqXG4gICAgICAgICAqIFRpY2tlciBmb3IgZG9pbmcgcmVuZGVyIHVwZGF0ZXMuXG4gICAgICAgICAqXG4gICAgICAgICAqIEB0eXBlIHtQSVhJLlRpY2tlcn1cbiAgICAgICAgICogQG5hbWUgdGlja2VyXG4gICAgICAgICAqIEBtZW1iZXJvZiBQSVhJLkFwcGxpY2F0aW9uI1xuICAgICAgICAgKiBAZGVmYXVsdCBQSVhJLlRpY2tlci5zaGFyZWRcbiAgICAgICAgICovXG4gICAgICAgIHRoaXMudGlja2VyID0gb3B0aW9ucy5zaGFyZWRUaWNrZXIgPyBUaWNrZXIuc2hhcmVkIDogbmV3IFRpY2tlcigpO1xuICAgICAgICAvLyBTdGFydCB0aGUgcmVuZGVyaW5nXG4gICAgICAgIGlmIChvcHRpb25zLmF1dG9TdGFydCkge1xuICAgICAgICAgICAgdGhpcy5zdGFydCgpO1xuICAgICAgICB9XG4gICAgfTtcbiAgICAvKipcbiAgICAgKiBDbGVhbiB1cCB0aGUgdGlja2VyLCBzY29wZWQgdG8gYXBwbGljYXRpb24uXG4gICAgICpcbiAgICAgKiBAc3RhdGljXG4gICAgICogQHByaXZhdGVcbiAgICAgKi9cbiAgICBUaWNrZXJQbHVnaW4uZGVzdHJveSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgaWYgKHRoaXMuX3RpY2tlcikge1xuICAgICAgICAgICAgdmFyIG9sZFRpY2tlciA9IHRoaXMuX3RpY2tlcjtcbiAgICAgICAgICAgIHRoaXMudGlja2VyID0gbnVsbDtcbiAgICAgICAgICAgIG9sZFRpY2tlci5kZXN0cm95KCk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIHJldHVybiBUaWNrZXJQbHVnaW47XG59KCkpO1xuXG5leHBvcnQgeyBUaWNrZXIsIFRpY2tlclBsdWdpbiwgVVBEQVRFX1BSSU9SSVRZIH07XG4vLyMgc291cmNlTWFwcGluZ1VSTD10aWNrZXIuZXMuanMubWFwXG4iXSwic291cmNlUm9vdCI6IiJ9